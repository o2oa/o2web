(function(){var e={r:function(t){if(e[t].inited){return e[t].value}if(typeof e[t].value==="function"){var r={exports:{}},n=e[t].value(null,r.exports,r);e[t].inited=true;e[t].value=n;if(n!==undefined){return n}else{for(var i in r.exports){if(r.exports.hasOwnProperty(i)){e[t].inited=true;e[t].value=r.exports;return r.exports}}}}else{e[t].inited=true;return e[t].value}}};e[0]={value:function(t,r,n){var i=e.r(17);var a=e.r(11);var o=(new i.Marker).pipe(function(){var e=7;var t=new i.Circle(e-1);this.addShape(t);this.setRef(e-1,0).setViewBox(-e,-e,e+e,e+e).setWidth(e).setHeight(e);this.dot=t;this.node.setAttribute("markerUnits","userSpaceOnUse")});a.register("arc",function(e,t,r,n,a){var s=e.getLayoutBox(),u=t.getLayoutBox();var c,l,h;var d=Math.abs;var f=[];var g=s.x>u.x?"right":"left";e.getMinder().getPaper().addResource(o);c=new i.Point(u.cx,u.cy);l=g=="left"?new i.Point(s.right+2,s.cy):new i.Point(s.left-2,s.cy);h=i.Vector.fromPoints(c,l);f.push("M",c);f.push("A",d(h.x),d(h.y),0,0,h.x*h.y>0?0:1,l);r.setMarker(o);o.dot.fill(a);r.setPathData(f)})}};e[1]={value:function(t,r,n){var i=e.r(17);var a=e.r(11);var o=(new i.Marker).pipe(function(){var e=7;var t=new i.Circle(e-1);this.addShape(t);this.setRef(e-1,0).setViewBox(-e,-e,e+e,e+e).setWidth(e).setHeight(e);this.dot=t;this.node.setAttribute("markerUnits","userSpaceOnUse")});a.register("arc_tp",function(e,t,r,n,a){var s=e.getLayoutBox(),u=t.getLayoutBox();var c=e.getIndex();var l=t.getChildren()[c+1];if(e.getIndex()>0){u=t.getChildren()[c-1].getLayoutBox()}var h,d,f;var g=Math.abs;var v=[];var p=s.x>u.x?"right":"left";e.getMinder().getPaper().addResource(o);h=new i.Point(u.cx,u.cy);d=new i.Point(s.cx,s.cy);var m=Math.sqrt(Math.pow(h.x-d.x,2)+Math.pow(h.y-d.y,2));m=e.getIndex()==0?m*.4:m;f=i.Vector.fromPoints(h,d);v.push("M",h);v.push("A",m,m,0,0,1,d);r.setMarker(o);o.dot.fill(a);r.setPathData(v);if(l&&l.getConnection()){var y=l.getConnection();var w=l.getLayoutBox();var b=new i.Point(w.cx,w.cy);var x=Math.sqrt(Math.pow(d.x-b.x,2)+Math.pow(d.y-b.y,2));v=[];v.push("M",d);v.push("A",x,x,0,0,1,b);y.setMarker(o);o.dot.fill(a);y.setPathData(v)}})}};e[2]={value:function(t,r,n){var i=e.r(17);var a=e.r(11);a.register("bezier",function(e,t,r){var n=t.getLayoutVertexOut(),i=e.getLayoutVertexIn();var a=t.getLayoutVectorOut().normalize();var o=Math.round;var s=Math.abs;var u=[];u.push("M",o(n.x),o(n.y));if(s(a.x)>s(a.y)){var c=(i.x+n.x)/2;u.push("C",c,n.y,c,i.y,i.x,i.y)}else{var l=(i.y+n.y)/2;u.push("C",n.x,l,i.x,l,i.x,i.y)}r.setMarker(null);r.setPathData(u)})}};e[3]={value:function(t,r,n){var i=e.r(17);var a=e.r(11);a.register("fish-bone-master",function(e,t,r){var n=t.getLayoutVertexOut(),i=e.getLayoutVertexIn();var a=Math.abs;var o=a(n.y-i.y),s=a(n.x-i.x);var u=[];u.push("M",n.x,n.y);u.push("h",s-o);u.push("L",i.x,i.y);r.setMarker(null);r.setPathData(u)})}};e[4]={value:function(t,r,n){var i=e.r(17);var a=e.r(11);a.register("l",function(e,t,r){var n=t.getLayoutVertexOut();var i=e.getLayoutVertexIn();var a=t.getLayoutVectorOut();var o=[];var s=Math.round,u=Math.abs;o.push("M",n.round());if(u(a.x)>u(a.y)){o.push("H",s(i.x))}else{o.push("V",i.y)}o.push("L",i);r.setPathData(o)})}};e[5]={value:function(t,r,n){var i=e.r(17);var a=e.r(11);a.register("poly",function(e,t,r,n){var i=t.getLayoutVertexOut(),a=e.getLayoutVertexIn();var o=t.getLayoutVectorOut().normalize();var s=Math.round;var u=Math.abs;var c=[];c.push("M",s(i.x),s(i.y));switch(true){case u(o.x)>u(o.y)&&o.x<0:c.push("h",-t.getStyle("margin-left"));c.push("v",a.y-i.y);c.push("H",a.x);break;case u(o.x)>u(o.y)&&o.x>=0:c.push("h",t.getStyle("margin-right"));c.push("v",a.y-i.y);c.push("H",a.x);break;case u(o.x)<=u(o.y)&&o.y<0:c.push("v",-t.getStyle("margin-top"));c.push("h",a.x-i.x);c.push("V",a.y);break;case u(o.x)<=u(o.y)&&o.y>=0:c.push("v",t.getStyle("margin-bottom"));c.push("h",a.x-i.x);c.push("V",a.y);break}r.setMarker(null);r.setPathData(c)})}};e[6]={value:function(t,r,n){var i=e.r(17);var a=e.r(11);a.register("under",function(e,t,r,n,a){var o=e.getLayoutBox(),s=t.getLayoutBox();var u,c,l;var h=Math.abs;var d=[];var f=o.x>s.x?"right":"left";var g=e.getStyle("connect-radius");var v=o.bottom+3;var p=t.getType()=="sub"?s.bottom+3:s.cy;var m,y,w,b;if(f=="right"){m=new i.Point(s.right,p);y=new i.Point(o.left-10,v);w=new i.Point(o.right,v)}else{m=new i.Point(s.left,p);y=new i.Point(o.right+10,v);w=new i.Point(o.left,v)}b=(m.x+y.x)/2;d.push("M",m);d.push("C",b,m.y,b,y.y,y);d.push("L",w);r.setMarker(null);r.setPathData(d)})}};e[7]={value:function(t,r,n){var i=e.r(17);var a=e.r(19);if(location.href.indexOf("boxv")!=-1){var o;Object.defineProperty(i.Box.prototype,"visualization",{get:function(){if(!o)return null;return o.setBox(this)}});a.registerInitHook(function(){this.on("paperrender",function(){o=new i.Rect;o.fill("rgba(200, 200, 200, .5)");o.stroke("orange");this.getRenderContainer().addShape(o)})})}}};e[8]={value:function(t,r,n){var i=e.r(19);var a={enableAnimation:true,layoutAnimationDuration:300,viewAnimationDuration:100,zoomAnimationDuration:300};var o={};i.registerInitHook(function(){this.setDefaultOptions(a);if(!this.getOption("enableAnimation")){this.disableAnimation()}});i.prototype.enableAnimation=function(){for(var e in a){if(a.hasOwnProperty(e)){this.setOption(o[e])}}};i.prototype.disableAnimation=function(){for(var e in a){if(a.hasOwnProperty(e)){o[e]=this.getOption(e);this.setOption(e,0)}}}}};e[9]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(13);var c=0;var l=-1;var h=1;var d=i.createClass("Command",{constructor:function(){this._isContentChange=true;this._isSelectionChange=false},execute:function(e,t){throw new Error("Not Implement: Command.execute()")},setContentChanged:function(e){this._isContentChange=!!e},isContentChanged:function(){return this._isContentChange},setSelectionChanged:function(e){this._isSelectionChange=!!e},isSelectionChanged:function(){return this._isContentChange},queryState:function(e){return c},queryValue:function(e){return 0},isNeedUndo:function(){return true}});d.STATE_NORMAL=c;d.STATE_ACTIVE=h;d.STATE_DISABLED=l;i.extendClass(o,{_getCommand:function(e){return this._commands[e.toLowerCase()]},_queryCommand:function(e,t,r){var n=this._getCommand(e);if(n){var i=n["query"+t];if(i)return i.apply(n,[this].concat(r))}return 0},queryCommandState:function(e){return this._queryCommand(e,"State",[].slice.call(arguments,1))},queryCommandValue:function(e){return this._queryCommand(e,"Value",[].slice.call(arguments,1))},execCommand:function(e){if(!e)return null;e=e.toLowerCase();var t=[].slice.call(arguments,1),r,n,i,a;var o=this;r=this._getCommand(e);a={command:r,commandName:e.toLowerCase(),commandArgs:t};if(!r||!~this.queryCommandState(e)){return false}if(!this._hasEnterExecCommand){this._hasEnterExecCommand=true;n=this._fire(new u("beforeExecCommand",a,true));if(!n){this._fire(new u("preExecCommand",a,false));i=r.execute.apply(r,[o].concat(t));this._fire(new u("execCommand",a,false));if(r.isContentChanged()){this._firePharse(new u("contentchange"))}this._interactChange()}this._hasEnterExecCommand=false}else{i=r.execute.apply(r,[o].concat(t));if(!this._hasEnterExecCommand){this._interactChange()}}return i===undefined?null:i}});n.exports=d}};e[10]={value:function(t,r,n){var i=e.r(33);function a(e){var t=e.version||(e.root?"1.4.0":"1.1.3");switch(t){case"1.1.3":u(e);case"1.2.0":case"1.2.1":s(e);case"1.3.0":case"1.3.1":case"1.3.2":case"1.3.3":case"1.3.4":case"1.3.5":c(e)}return e}function o(e,t){t(e);if(e.children)e.children.forEach(function(e){o(e,t)})}function s(e){o(e,function(e){var t=e.data;delete t.layout_bottom_offset;delete t.layout_default_offset;delete t.layout_filetree_offset})}function u(e){var t=e.data.currentstyle;delete e.data.currentstyle;if(t=="bottom"){e.template="structure";e.theme="snow"}else if(t=="default"){e.template="default";e.theme="classic"}o(e,function(e){var t=e.data;if("PriorityIcon"in t){t.priority=t.PriorityIcon;delete t.PriorityIcon}if("ProgressIcon"in t){t.progress=1+(t.ProgressIcon-1<<1);delete t.ProgressIcon}delete t.point;delete t.layout})}function c(e){e.root={data:e.data,children:e.children};delete e.data;delete e.children}return a}};e[11]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(20);var s=e.r(19);var u=e.r(21);var c={};function l(e,t){c[e]=t}l("default",function(e,t,r){r.setPathData(["M",t.getLayoutVertexOut(),"L",e.getLayoutVertexIn()])});i.extendClass(u,{getConnect:function(){return this.data.connect||"default"},getConnectProvider:function(){return c[this.getConnect()]||c["default"]},getConnection:function(){return this._connection||null}});i.extendClass(s,{getConnectContainer:function(){return this._connectContainer},createConnect:function(e){if(e.isRoot())return;var t=new i.Path;e._connection=t;this._connectContainer.addShape(t);this.updateConnect(e)},removeConnect:function(e){var t=this;e.traverse(function(e){t._connectContainer.removeShape(e._connection);e._connection=null})},updateConnect:function(e){var t=e._connection;var r=e.parent;if(!r||!t)return;if(r.isCollapsed()){t.setVisible(false);return}t.setVisible(true);var n=e.getConnectProvider();var i=e.getStyle("connect-color")||"white",a=e.getStyle("connect-width")||2;t.stroke(i,a);n(e,r,t,a,i);if(a%2===0){t.setTranslate(.5,.5)}else{t.setTranslate(0,0)}}});o.register("Connect",{init:function(){this._connectContainer=(new i.Group).setId(a.uuid("minder_connect_group"));this.getRenderContainer().prependShape(this._connectContainer)},events:{nodeattach:function(e){this.createConnect(e.node)},nodedetach:function(e){this.removeConnect(e.node)},"layoutapply layoutfinish noderender":function(e){this.updateConnect(e.node)}}});r.register=l}};e[12]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(13);var c=e.r(10);var l=e.r(25);var h={};function d(e,t){h[e]=t;for(var r in h){if(h.hasOwnProperty(r)){h[r]=h[r];h[r].name=r}}}function f(e){return e===undefined?h:h[e]||null}r.registerProtocol=d;r.getRegisterProtocol=f;i.extendClass(o,{setup:function(e){if(typeof e=="string"){e=document.querySelector(e)}if(!e)return;var t=e.getAttribute("minder-data-type");if(t in h){var r=e.textContent;e.textContent=null;this.renderTo(e);this.importData(t,r)}return this},exportJson:function(){function e(t){var r={};r.data=t.getData();var n=t.getChildren();r.children=[];for(var i=0;i<n.length;i++){r.children.push(e(n[i]))}return r}var t={root:e(this.getRoot())};t.template=this.getTemplate();t.theme=this.getTheme();t.version=o.version;return JSON.parse(JSON.stringify(t))},Text2Children:function(e,t){if(!(e instanceof kityminder.Node)){return}var r=[],n={},i=0;var a=/\r|\n|\r\n/,o=/^(\t|\x20{4})/;var s=t.split(a),u="",c,l=0;var h=this;function d(e){return e===""&&!/\S/.test(e)}function f(e){return{data:{text:e.replace(/^(\t|\x20{4})+/,"").replace(/(\t|\x20{4})+$/,"")},children:[]}}function g(e){var t=0;while(o.test(e)){e=e.replace(o,"");t++}return t}function v(e,t){e.children.push(t)}function p(e,t){for(var r=0,n=t.length;r<n;r++){var i=h.createNode(null,e);i.setData("text",t[r].data.text||"");p(i,t[r].children)}}while((u=s[l++])!==undefined){u=u.replace(/&nbsp;/g,"");if(d(u))continue;i=g(u);c=f(u);if(i===0){n={};r.push(c);n[0]=r[r.length-1]}else{if(!n[i-1]){throw new Error("Invalid local format")}v(n[i-1],c);n[i]=c}}p(e,r);h.refresh()},exportNode:function(e){var t={};t.data=e.getData();var r=e.getChildren();t.children=[];for(var n=0;n<r.length;n++){t.children.push(this.exportNode(r[n]))}return t},importNode:function(e,t){var r=t.data;e.data={};for(var n in r){e.setData(n,r[n])}var i=t.children||[];for(var a=0;a<i.length;a++){var o=this.createNode(null,e);this.importNode(o,i[a])}return e},importJson:function(e){if(!e)return;this._fire(new u("preimport",null,false));while(this._root.getChildren().length){this.removeNode(this._root.getChildren()[0])}e=c(e);this.importNode(this._root,e.root);this.setTemplate(e.template||"default");this.setTheme(e.theme||null);this.refresh();this.fire("import");this._firePharse({type:"contentchange"});this._interactChange();return this},exportData:function(e,t){var r,n;r=this.exportJson();if(e){n=h[e];if(!n||!n.encode){return l.reject(new Error("Not supported protocol:"+e))}}this._fire(new u("beforeexport",{json:r,protocolName:e,protocol:n}));return l.resolve(n.encode(r,this,t))},importData:function(e,t,r){var n,i;var a=this;if(e){i=h[e];if(!i||!i.decode){return l.reject(new Error("Not supported protocol:"+e))}}var o={local:t,protocolName:e,protocol:i};this._fire(new u("beforeimport",o));return l.resolve(i.decode(t,this,r)).then(function(e){a.importJson(e);return e})},decodeData:function(e,t,r){var n,i;var a=this;if(e){i=h[e];if(!i||!i.decode){return l.reject(new Error("Not supported protocol:"+e))}}var o={local:t,protocolName:e,protocol:i};this._fire(new u("beforeimport",o));return l.resolve(i.decode(t,this,r))}})}};e[13]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=i.createClass("MindEvent",{constructor:function(e,t,r){t=t||{};if(t.getType&&t.getType()=="ShapeEvent"){this.kityEvent=t;this.originEvent=t.originEvent}else if(t.target&&t.preventDefault){this.originEvent=t}else{i.Utils.extend(this,t)}this.type=e;this._canstop=r||false},getPosition:function(e){if(!this.kityEvent)return;if(!e||e=="minder"){return this.kityEvent.getPosition(this.minder.getRenderContainer())}return this.kityEvent.getPosition.call(this.kityEvent,e)},getTargetNode:function(){var e=this.kityEvent&&this.kityEvent.targetShape;if(!e)return null;while(!e.minderNode&&e.container){e=e.container}var t=e.minderNode;if(t&&e.getOpacity()<1)return null;return t||null},stopPropagation:function(){this._stoped=true},stopPropagationImmediately:function(){this._immediatelyStoped=true;this._stoped=true},shouldStopPropagation:function(){return this._canstop&&this._stoped},shouldStopPropagationImmediately:function(){return this._canstop&&this._immediatelyStoped},preventDefault:function(){this.originEvent.preventDefault()},isRightMB:function(){var e=false;if(!this.originEvent){return false}if("which"in this.originEvent)e=this.originEvent.which==3;else if("button"in this.originEvent)e=this.originEvent.button==2;return e},getKeyCode:function(){var e=this.originEvent;return e.keyCode||e.which}});o.registerInitHook(function(e){this._initEvents()});i.extendClass(o,{_initEvents:function(){this._eventCallbacks={}},_resetEvents:function(){this._initEvents();this._bindEvents()},_bindEvents:function(){this._paper.on("click dblclick mousedown contextmenu mouseup mousemove mouseover mousewheel DOMMouseScroll touchstart touchmove touchend dragenter dragleave drop",this._firePharse.bind(this));if(window){window.addEventListener("resize",this._firePharse.bind(this))}},dispatchKeyEvent:function(e){this._firePharse(e)},_firePharse:function(e){var t,r,n;if(e.type=="DOMMouseScroll"){e.type="mousewheel";e.wheelDelta=e.originEvent.wheelDelta=e.originEvent.detail*-10;e.wheelDeltaX=e.originEvent.mozMovementX;e.wheelDeltaY=e.originEvent.mozMovementY}t=new s("before"+e.type,e,true);if(this._fire(t)){return}r=new s("pre"+e.type,e,true);n=new s(e.type,e,true);if(this._fire(r)||this._fire(n))this._fire(new s("after"+e.type,e,false))},_interactChange:function(e){var t=this;if(t._interactScheduled)return;setTimeout(function(){t._fire(new s("interactchange"));t._interactScheduled=false},100);t._interactScheduled=true},_listen:function(e,t){var r=this._eventCallbacks[e]||(this._eventCallbacks[e]=[]);r.push(t)},_fire:function(e){e.minder=this;var t=this.getStatus();var r=this._eventCallbacks[e.type.toLowerCase()]||[];if(t){r=r.concat(this._eventCallbacks[t+"."+e.type.toLowerCase()]||[])}if(r.length===0){return}var n=this.getStatus();for(var i=0;i<r.length;i++){r[i].call(this,e);if(e.shouldStopPropagationImmediately()){break}}return e.shouldStopPropagation()},on:function(e,t){var r=this;e.split(/\s+/).forEach(function(e){r._listen(e.toLowerCase(),t)});return this},off:function(e,t){var r=e.split(/\s+/);var n,i,a,o;for(n=0;n<r.length;n++){a=this._eventCallbacks[r[n].toLowerCase()];if(a){o=null;for(i=0;i<a.length;i++){if(a[i]==t){o=i}}if(o!==null){a.splice(o,1)}}}},fire:function(e,t){var r=new s(e,t);this._fire(r);return this}});n.exports=s}};e[14]={value:function(t,r,n){var i=e.r(17);var a=e.r(19);a.registerInitHook(function(){this.on("beforemousedown",function(e){this.focus();e.preventDefault()});this.on("paperrender",function(){this.focus()})});i.extendClass(a,{focus:function(){if(!this.isFocused()){var e=this._renderTarget;e.classList.add("focus");this.renderNodeBatch(this.getSelectedNodes())}this.fire("focus");return this},blur:function(){if(this.isFocused()){var e=this._renderTarget;e.classList.remove("focus");this.renderNodeBatch(this.getSelectedNodes())}this.fire("blur");return this},isFocused:function(){var e=this._renderTarget;return e&&e.classList.contains("focus")}})}};e[15]={value:function(e,t,r){var n={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Left:37,Up:38,Right:39,Down:40,direction:{37:1,38:1,39:1,40:1},Del:46,NumLock:144,Cmd:91,CmdFF:224,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,"-":189,"/":191,".":190,controlKeys:{16:1,17:1,18:1,20:1,91:1,224:1},notContentChange:{13:1,9:1,33:1,34:1,35:1,36:1,16:1,17:1,18:1,20:1,91:1,37:1,38:1,39:1,40:1,113:1,114:1,115:1,144:1,27:1},isSelectedNodeKey:{37:1,38:1,39:1,40:1,13:1,9:1}};for(var i in n){if(n.hasOwnProperty(i)){n[i.toLowerCase()]=n[i]}}var a=65;var o="a".charCodeAt(0);"abcdefghijklmnopqrstuvwxyz".split("").forEach(function(e){n[e]=a+(e.charCodeAt(0)-o)});var s=9;do{n[s.toString()]=s+48}while(--s);r.exports=n}};e[16]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);function s(e,t,r){t.split(" ").forEach(function(t){e.addEventListener(t,r,false)})}o.registerInitHook(function(e){this.setDefaultOptions({enableKeyReceiver:true});if(this.getOption("enableKeyReceiver")){this.on("paperrender",function(){this._initKeyReceiver()})}});i.extendClass(o,{_initKeyReceiver:function(){if(this._keyReceiver)return;var e=this._keyReceiver=document.createElement("input");e.classList.add("km-receiver");var t=this._renderTarget;t.appendChild(e);var r=this;s(e,"keydown keyup keypress copy paste blur focus input",function(t){switch(t.type){case"blur":r.blur();break;case"focus":r.focus();break;case"input":e.value=null;break}r._firePharse(t);t.preventDefault()});this.on("focus",function(){e.select();e.focus()});this.on("blur",function(){e.blur()});if(this.isFocused()){e.select();e.focus()}}})}};e[17]={value:function(e,t,r){r.exports=window.kity}};e[18]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(13);var c=e.r(9);var l={};var h;function d(e,t){l[e]=t;h=h||e}var f=i.createClass("Layout",{doLayout:function(e,t){throw new Error("Not Implement: Layout.doLayout()")},align:function(e,t,r){var n=this;r=r||0;e.forEach(function(e){var i=n.getTreeBox([e]);var a=e.getLayoutTransform();switch(t){case"left":return a.translate(r-i.left,0);case"right":return a.translate(r-i.right,0);case"top":return a.translate(0,r-i.top);case"bottom":return a.translate(0,r-i.bottom)}})},stack:function(e,t,r){var n=this;var i=0;r=r||function(e,t,r){return e.getStyle({x:"margin-right",y:"margin-bottom"}[r])+t.getStyle({x:"margin-left",y:"margin-top"}[r])};e.forEach(function(e,a,o){var s=n.getTreeBox([e]);var u={x:s.width,y:s.height}[t];var c={x:s.left,y:s.top}[t];var l=e.getLayoutTransform();if(t=="x"){l.translate(i-c,0)}else{l.translate(0,i-c)}i+=u;if(o[a+1])i+=r(e,o[a+1],t)});return i},move:function(e,t,r){e.forEach(function(e){e.getLayoutTransform().translate(t,r)})},getBranchBox:function(e){var t=new i.Box;var r,n,a,o;for(r=0;r<e.length;r++){n=e[r];a=n.getLayoutTransform();o=n.getContentBox();t=t.merge(a.transformBox(o))}return t},getTreeBox:function(e){var t,r,n,a;var o=new i.Box;if(!(e instanceof Array))e=[e];for(t=0;t<e.length;t++){r=e[t];n=r.getLayoutTransform();a=r.getContentBox();if(r.isExpanded()&&r.children.length){a=a.merge(this.getTreeBox(r.children))}o=o.merge(n.transformBox(a))}return o},getOrderHint:function(e){return[]}});f.register=d;o.registerInitHook(function(e){this.refresh()});a.extend(o,{getLayoutList:function(){return l},getLayoutInstance:function(e){var t=l[e];if(!t)throw new Error("Missing Layout: "+e);var r=new t;return r}});i.extendClass(s,{getLayout:function(){var e=this.getData("layout");e=e||(this.isRoot()?h:this.parent.getLayout());return e},setLayout:function(e){if(e){if(e=="inherit"){this.setData("layout")}else{this.setData("layout",e)}}return this},layout:function(e){this.setLayout(e).getMinder().layout();return this},getLayoutInstance:function(){return o.getLayoutInstance(this.getLayout())},getOrderHint:function(e){return this.parent.getLayoutInstance().getOrderHint(this)},getLayoutTransform:function(){return this._layoutTransform||new i.Matrix},getGlobalLayoutTransformPreview:function(){var e=this.parent?this.parent.getLayoutTransform():new i.Matrix;var t=this.getLayoutTransform();var r=this.getLayoutOffset();if(r){t=t.clone().translate(r.x,r.y)}return e.merge(t)},getLayoutPointPreview:function(){return this.getGlobalLayoutTransformPreview().transformPoint(new i.Point)},getGlobalLayoutTransform:function(){if(this._globalLayoutTransform){return this._globalLayoutTransform}else if(this.parent){return this.parent.getGlobalLayoutTransform()}else{return new i.Matrix}},setLayoutTransform:function(e){this._layoutTransform=e;return this},setGlobalLayoutTransform:function(e){this.getRenderContainer().setMatrix(this._globalLayoutTransform=e);return this},setVertexIn:function(e){this._vertexIn=e},setVertexOut:function(e){this._vertexOut=e},getVertexIn:function(){return this._vertexIn||new i.Point},getVertexOut:function(){return this._vertexOut||new i.Point},getLayoutVertexIn:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexIn())},getLayoutVertexOut:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexOut())},setLayoutVectorIn:function(e){this._layoutVectorIn=e;return this},setLayoutVectorOut:function(e){this._layoutVectorOut=e;return this},getLayoutVectorIn:function(){return this._layoutVectorIn||new i.Vector},getLayoutVectorOut:function(){return this._layoutVectorOut||new i.Vector},getLayoutBox:function(){var e=this.getGlobalLayoutTransform();return e.transformBox(this.getContentBox())},getLayoutPoint:function(){var e=this.getGlobalLayoutTransform();return e.transformPoint(new i.Point)},getLayoutOffset:function(){if(!this.parent)return new i.Point;var e=this.getData("layout_"+this.parent.getLayout()+"_offset");if(e)return new i.Point(e.x,e.y);return new i.Point},setLayoutOffset:function(e){if(!this.parent)return this;this.setData("layout_"+this.parent.getLayout()+"_offset",e?{x:e.x,y:e.y}:undefined);return this},hasLayoutOffset:function(){return!!this.getData("layout_"+this.parent.getLayout()+"_offset")},resetLayoutOffset:function(){return this.setLayoutOffset(null)},getLayoutRoot:function(){if(this.isLayoutRoot()){return this}return this.parent.getLayoutRoot()},isLayoutRoot:function(){return this.getData("layout")||this.isRoot()}});i.extendClass(o,{layout:function(){var e=this.getOption("layoutAnimationDuration");this.getRoot().traverse(function(e){e.setLayoutTransform(null)});function t(e,r){if(e.isExpanded()||true){e.children.forEach(function(e){t(e,r)})}var n=e.getLayoutInstance();n.doLayout(e,e.getChildren(),r)}t(this.getRoot(),1);t(this.getRoot(),2);var r=this;this.applyLayoutResult(this.getRoot(),e,function(){setTimeout(function(){r.fire("layoutallfinish")},0)});return this.fire("layout")},refresh:function(){this.getRoot().renderTree();this.layout().fire("contentchange")._interactChange();return this},applyLayoutResult:function(e,t,r){e=e||this.getRoot();var n=this;var a=e.getComplex();function o(){if(!--a){if(r){r()}}}if(a>200)t=0;function s(e,t){e.setGlobalLayoutTransform(t);n.fire("layoutapply",{node:e,matrix:t})}function u(e,r){var a=e.getLayoutTransform().merge(r.clone());var c=e.getGlobalLayoutTransform()||new i.Matrix;var l=e.getLayoutOffset();a.translate(l.x,l.y);a.m.e=Math.round(a.m.e);a.m.f=Math.round(a.m.f);if(e._layoutTimeline){e._layoutTimeline.stop();e._layoutTimeline=null}if(t){e._layoutTimeline=new i.Animator(c,a,s).start(e,t,"ease").on("finish",function(){setTimeout(function(){s(e,a);n.fire("layoutfinish",{node:e,matrix:a});o()},150)})}else{s(e,a);n.fire("layoutfinish",{node:e,matrix:a});o()}for(var h=0;h<e.children.length;h++){u(e.children[h],a)}}u(e,e.parent?e.parent.getGlobalLayoutTransform():new i.Matrix);return this}});n.exports=f}};e[19]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=[];var s=i.createClass("Minder",{constructor:function(e){this._options=a.extend({},e);var t=o.slice();var r;while(t.length){r=t.shift();if(typeof r=="function"){r.call(this,this._options)}}this.fire("finishInitHook")}});s.version="1.4.33";s.registerInitHook=function(e){o.push(e)};n.exports=s}};e[20]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s={};r.register=function(e,t){s[e]=t};o.registerInitHook(function(){this._initModules()});i.extendClass(o,{_initModules:function(){var e=s;var t=this._options.modules||a.keys(e);this._commands={};this._query={};this._modules={};this._rendererClasses={};var r,n,i,o,u,c,l,h;var d=this;for(r=0;r<t.length;r++){n=t[r];if(!e[n])continue;if(typeof e[n]=="function"){u=e[n].call(d)}else{u=e[n]}this._modules[n]=u;if(!u)continue;if(u.defaultOptions){d.setDefaultOptions(u.defaultOptions)}if(u.init){u.init.call(d,this._options)}c=u.commands;for(n in c){this._commands[n.toLowerCase()]=new c[n]}l=u.events;if(l){for(i in l){d.on(i,l[i])}}h=u.renderers;if(h){for(i in h){this._rendererClasses[i]=this._rendererClasses[i]||[];if(a.isArray(h[i])){this._rendererClasses[i]=this._rendererClasses[i].concat(h[i])}else{this._rendererClasses[i].push(h[i])}}}if(u.commandShortcutKeys){this.addCommandShortcutKeys(u.commandShortcutKeys)}}},_garbage:function(){this.clearSelect();while(this._root.getChildren().length){this._root.removeChild(0)}},destroy:function(){var e=this._modules;this._resetEvents();this._garbage();for(var t in e){if(!e[t].destroy)continue;e[t].destroy.call(this)}},reset:function(){var e=this._modules;this._garbage();for(var t in e){if(!e[t].reset)continue;e[t].reset.call(this)}}})}};e[21]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=i.createClass("MinderNode",{constructor:function(e){this.parent=null;this.root=this;this.children=[];this.data={id:a.guid(),created:+new Date};this.initContainers();if(a.isString(e)){this.setText(e)}else if(a.isObject(e)){a.extend(this.data,e)}},initContainers:function(){this.rc=(new i.Group).setId(a.uuid("minder_node"));this.rc.minderNode=this},isRoot:function(){return this.root===this},isLeaf:function(){return this.children.length===0},getRoot:function(){return this.root||this},getParent:function(){return this.parent},getSiblings:function(){var e=this.parent.children;var t=[];var r=this;e.forEach(function(e){if(e!=r)t.push(e)});return t},getLevel:function(){var e=0,t=this.parent;while(t){e++;t=t.parent}return e},getComplex:function(){var e=0;this.traverse(function(){e++});return e},getType:function(e){this.type=["root","main","sub"][Math.min(this.getLevel(),2)];return this.type},isAncestorOf:function(e){var t=e.parent;while(t){if(t==this)return true;t=t.parent}return false},getData:function(e){return e?this.data[e]:this.data},setData:function(e,t){if(typeof e=="object"){var r=e;for(e in r)if(r.hasOwnProperty(e)){this.data[e]=r[e]}}else{this.data[e]=t}return this},setText:function(e){return this.data.text=e},getText:function(){return this.data.text||null},preTraverse:function(e,t){var r=this.getChildren();if(!t)e(this);for(var n=0;n<r.length;n++){r[n].preTraverse(e)}},postTraverse:function(e,t){var r=this.getChildren();for(var n=0;n<r.length;n++){r[n].postTraverse(e)}if(!t)e(this)},traverse:function(e,t){return this.postTraverse(e,t)},getChildren:function(){return this.children},getIndex:function(){return this.parent?this.parent.children.indexOf(this):-1},insertChild:function(e,t){if(t===undefined){t=this.children.length}if(e.parent){e.parent.removeChild(e)}e.parent=this;e.root=this.root;this.children.splice(t,0,e)},appendChild:function(e){return this.insertChild(e)},prependChild:function(e){return this.insertChild(e,0)},removeChild:function(e){var t=e,r;if(e instanceof s){t=this.children.indexOf(e)}if(t>=0){r=this.children.splice(t,1)[0];r.parent=null;r.root=r}},clearChildren:function(){this.children=[]},getChild:function(e){return this.children[e]},getRenderContainer:function(){return this.rc},getCommonAncestor:function(e){return s.getNodeCommonAncestor(this,e)},contains:function(e){return this==e||this.isAncestorOf(e)},clone:function(){var e=new s;e.data=a.clone(this.data);this.children.forEach(function(t){e.appendChild(t.clone())});return e},compareTo:function(e){if(!a.comparePlainObject(this.data,e.data))return false;if(!a.comparePlainObject(this.temp,e.temp))return false;if(this.children.length!=e.children.length)return false;var t=0;while(this.children[t]){if(!this.children[t].compareTo(e.children[t]))return false;t++}return true},getMinder:function(){return this.getRoot().minder}});s.getCommonAncestor=function(e,t){if(e instanceof Array){return s.getCommonAncestor.apply(this,e)}switch(arguments.length){case 1:return e.parent||e;case 2:if(e.isAncestorOf(t)){return e}if(t.isAncestorOf(e)){return t}var r=e.parent;while(r&&!r.isAncestorOf(t)){r=r.parent}return r;default:return Array.prototype.reduce.call(arguments,function(e,t){return s.getCommonAncestor(e,t)},e)}};i.extendClass(o,{getRoot:function(){return this._root},setRoot:function(e){this._root=e;e.minder=this},getAllNode:function(){var e=[];this.getRoot().traverse(function(t){e.push(t)});return e},getNodeById:function(e){return this.getNodesById([e])[0]},getNodesById:function(e){var t=this.getAllNode();var r=[];t.forEach(function(t){if(e.indexOf(t.getData("id"))!=-1){r.push(t)}});return r},createNode:function(e,t,r){var n=new s(e);this.fire("nodecreate",{node:n,parent:t,index:r});this.appendNode(n,t,r);return n},appendNode:function(e,t,r){if(t)t.insertChild(e,r);this.attachNode(e);return this},removeNode:function(e){if(e.parent){e.parent.removeChild(e);this.detachNode(e);this.fire("noderemove",{node:e})}},attachNode:function(e){var t=this.getRenderContainer();e.traverse(function(e){e.attached=true;t.addShape(e.getRenderContainer())});t.addShape(e.getRenderContainer());this.fire("nodeattach",{node:e})},detachNode:function(e){var t=this.getRenderContainer();e.traverse(function(e){e.attached=false;t.removeShape(e.getRenderContainer())});this.fire("nodedetach",{node:e})},getMinderTitle:function(){return this.getRoot().getText()}});n.exports=s}};e[22]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);o.registerInitHook(function(e){this._defaultOptions={}});i.extendClass(o,{setDefaultOptions:function(e){a.extend(this._defaultOptions,e);return this},getOption:function(e){if(e){return e in this._options?this._options[e]:this._defaultOptions[e]}else{return a.extend({},this._defaultOptions,this._options)}},setOption:function(e,t){this._options[e]=t}})}};e[23]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);o.registerInitHook(function(){this._initPaper()});i.extendClass(o,{_initPaper:function(){this._paper=new i.Paper;this._paper._minder=this;this._paper.getNode().ondragstart=function(e){e.preventDefault()};this._paper.shapeNode.setAttribute("transform","translate(0.5, 0.5)");this._addRenderContainer();this.setRoot(this.createNode());if(this._options.renderTo){this.renderTo(this._options.renderTo)}},_addRenderContainer:function(){this._rc=(new i.Group).setId(a.uuid("minder"));this._paper.addShape(this._rc)},renderTo:function(e){if(typeof e=="string"){e=document.querySelector(e)}if(e){if(e.tagName.toLowerCase()=="script"){var t=document.createElement("div");
t.id=e.id;t.class=e.class;e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e);e=t}e.classList.add("km-view");this._paper.renderTo(this._renderTarget=e);this._bindEvents();this.fire("paperrender")}return this},getRenderContainer:function(){return this._rc},getPaper:function(){return this._paper},getRenderTarget:function(){return this._renderTarget}})}};e[24]={value:function(t,r,n){var i=e.r(17);var a=e.r(19);function o(e,t,r,n){r=e.createNode(t.data,r,n);t.children.forEach(function(t,n){o(e,t,r,n)});return r}function s(e,t){var r=t.path.split("/");r.shift();var n=r.shift();var i;if(n=="root"){var a=r.indexOf("data");if(a>-1){n="data";var s=r.splice(a+1);t.dataPath=s}else{n="node"}i=e.getRoot();var u,c;while(u=r.shift()){if(u=="children")continue;if(typeof c!="undefined")i=i.getChild(c);c=+u}t.index=c;t.node=i}var l=t.express=[n,t.op].join(".");switch(l){case"theme.replace":e.useTheme(t.value);break;case"template.replace":e.useTemplate(t.value);break;case"node.add":o(e,t.value,t.node,t.index).renderTree();e.layout();break;case"node.remove":e.removeNode(t.node.getChild(t.index));e.layout();break;case"data.add":case"data.replace":case"data.remove":var h=t.node.data;var d;r=t.dataPath.slice();while(h&&r.length>1){d=r.shift();if(d in h){h=h[d]}else if(t.op!="remove"){h=h[d]={}}}if(h){d=r.shift();h[d]=t.value}if(d=="expandState"){i.renderTree()}else{i.render()}e.layout()}e.fire("patch",{patch:t})}i.extendClass(a,{applyPatches:function(e){for(var t=0;t<e.length;t++){s(this,e[t])}this.fire("contentchange");return this}})}};e[25]={value:function(e,t,r){var n=0;var i=1;var a=2;var o=function(e){if(!(this instanceof o))return new o(e);this.id="Thenable/1.0.7";this.state=n;this.fulfillValue=undefined;this.rejectReason=undefined;this.onFulfilled=[];this.onRejected=[];if(typeof e==="function")e.call(this,this.fulfill.bind(this),this.reject.bind(this))};o.prototype={fulfill:function(e){return s(this,i,"fulfillValue",e)},reject:function(e){return s(this,a,"rejectReason",e)},then:function(e,t){var r=this;var n=new o;r.onFulfilled.push(l(e,n,"fulfill"));r.onRejected.push(l(t,n,"reject"));u(r);return n}};o.all=function(e){return new o(function(t,r){var n=e.length,i=0,a=0,o=[];if(n===0){t(o)}while(i<n){e[i].then(function(e){o.push(e);if(++a===n){t(o)}},function(e){r(e)});i++}})};var s=function(e,t,r,i){if(e.state===n){e.state=t;e[r]=i;u(e)}return e};var u=function(e){if(e.state===i)c(e,"onFulfilled",e.fulfillValue);else if(e.state===a)c(e,"onRejected",e.rejectReason)};var c=function(e,t,r){if(e[t].length===0)return;var n=e[t];e[t]=[];var i=function(){for(var e=0;e<n.length;e++)n[e](r)};if(typeof process==="object"&&typeof process.nextTick==="function")process.nextTick(i);else if(typeof setImmediate==="function")setImmediate(i);else setTimeout(i,0)};var l=function(e,t,r){return function(n){if(typeof e!=="function")t[r].call(t,n);else{var i;try{if(n instanceof o){i=n.then(e)}else i=e(n)}catch(e){t.reject(e);return}h(t,i)}}};var h=function(e,t){if(e===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var r;if(typeof t==="object"&&t!==null||typeof t==="function"){try{r=t.then}catch(t){e.reject(t);return}}if(typeof r==="function"){var n=false;try{r.call(t,function(r){if(n)return;n=true;if(r===t)e.reject(new TypeError("circular thenable chain"));else h(e,r)},function(t){if(n)return;n=true;e.reject(t)})}catch(t){if(!n)e.reject(t)}return}e.fulfill(t)};o.resolve=function(e){return new o(function(t){t(e)})};o.reject=function(e){return new o(function(t,r){r(e)})};r.exports=o}};e[26]={value:function(t,r,n){var i=e.r(17);var a=e.r(19);var o=e.r(13);a.registerInitHook(function(e){if(e.readOnly){this.setDisabled()}});i.extendClass(a,{disable:function(){var e=this;e.bkqueryCommandState=e.queryCommandState;e.bkqueryCommandValue=e.queryCommandValue;e.queryCommandState=function(t){var r=this._getCommand(t);if(r&&r.enableReadOnly){return e.bkqueryCommandState.apply(e,arguments)}return-1};e.queryCommandValue=function(t){var r=this._getCommand(t);if(r&&r.enableReadOnly){return e.bkqueryCommandValue.apply(e,arguments)}return null};this.setStatus("readonly");e._interactChange()},enable:function(){var e=this;if(e.bkqueryCommandState){e.queryCommandState=e.bkqueryCommandState;delete e.bkqueryCommandState}if(e.bkqueryCommandValue){e.queryCommandValue=e.bkqueryCommandValue;delete e.bkqueryCommandValue}this.setStatus("normal");e._interactChange()}})}};e[27]={value:function(t,r,n){var i=e.r(17);var a=e.r(19);var o=e.r(21);var s=i.createClass("Renderer",{constructor:function(e){this.node=e},create:function(e){throw new Error("Not implement: Renderer.create()")},shouldRender:function(e){return true},watchChange:function(e){var t;if(this.watchingData===undefined){t=true}else if(this.watchingData!=e){t=true}else{t=false}this.watchingData=e},shouldDraw:function(e){return true},update:function(e,t,r){if(this.shouldDraw())this.draw(e,t);return this.place(e,t,r)},draw:function(e,t){throw new Error("Not implement: Renderer.draw()")},place:function(e,t,r){throw new Error("Not implement: Renderer.place()")},getRenderShape:function(){return this._renderShape||null},setRenderShape:function(e){this._renderShape=e}});function u(){function e(e,t){var r=[];["center","left","right","top","bottom","outline","outside"].forEach(function(e){var n="before"+e;var i="after"+e;if(t[n]){r=r.concat(t[n])}if(t[e]){r=r.concat(t[e])}if(t[i]){r=r.concat(t[i])}});e._renderers=r.map(function(t){return new t(e)})}return{renderNodeBatch:function(t){var r=this._rendererClasses;var n=[];var a=0;var o,s,u,c;if(!t.length)return;for(s=0;s<t.length;s++){c=t[s];if(!c._renderers){e(c,r)}c._contentBox=new i.Box;this.fire("beforerender",{node:c})}a=t[0]._renderers.length;for(o=0;o<a;o++){for(s=0;s<t.length;s++){if(typeof n[s]=="function"){n[s]=n[s]()}if(!(n[s]instanceof i.Box)){n[s]=new i.Box(n[s])}}for(s=0;s<t.length;s++){c=t[s];u=c._renderers[o];if(n[s]){c._contentBox=c._contentBox.merge(n[s]);u.contentBox=n[s]}if(u.shouldRender(c)){if(!u.getRenderShape()){u.setRenderShape(u.create(c));if(u.bringToBack){c.getRenderContainer().prependShape(u.getRenderShape())}else{c.getRenderContainer().appendShape(u.getRenderShape())}}u.getRenderShape().setVisible(true);n[s]=u.update(u.getRenderShape(),c,c._contentBox)}else if(u.getRenderShape()){u.getRenderShape().setVisible(false);n[s]=null}}}for(s=0;s<t.length;s++){this.fire("noderender",{node:t[s]})}},renderNode:function(t){var r=this._rendererClasses;var n,a,o;if(!t._renderers){e(t,r)}this.fire("beforerender",{node:t});t._contentBox=new i.Box;t._renderers.forEach(function(e){if(e.shouldRender(t)){if(!e.getRenderShape()){e.setRenderShape(e.create(t));if(e.bringToBack){t.getRenderContainer().prependShape(e.getRenderShape())}else{t.getRenderContainer().appendShape(e.getRenderShape())}}e.getRenderShape().setVisible(true);a=e.update(e.getRenderShape(),t,t._contentBox);if(typeof a=="function")a=a();if(a){t._contentBox=t._contentBox.merge(a);e.contentBox=a}}else if(e.getRenderShape()){e.getRenderShape().setVisible(false)}});this.fire("noderender",{node:t})}}}i.extendClass(a,u());i.extendClass(o,{render:function(){if(!this.attached)return;this.getMinder().renderNode(this);return this},renderTree:function(){if(!this.attached)return;var e=[];this.traverse(function(t){e.push(t)});this.getMinder().renderNodeBatch(e);return this},getRenderer:function(e){var t=this._renderers;if(!t)return null;for(var r=0;r<t.length;r++){if(t[r].getType()==e)return t[r]}return null},getContentBox:function(){return this.parent&&this.parent.isCollapsed()?new i.Box:this._contentBox||new i.Box},getRenderBox:function(e,t){var r=e&&this.getRenderer(e);var n=r?r.contentBox:this.getContentBox();var a=i.Matrix.getCTM(this.getRenderContainer(),t||"paper");return a.transformBox(n)}});n.exports=s}};e[28]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);o.registerInitHook(function(){this._initSelection()});i.extendClass(o,{_initSelection:function(){this._selectedNodes=[]},renderChangedSelection:function(e){var t=this.getSelectedNodes();var r=[];t.forEach(function(t){if(e.indexOf(t)==-1){r.push(t)}});e.forEach(function(e){if(t.indexOf(e)==-1){r.push(e)}});if(r.length){this._interactChange();this.fire("selectionchange")}while(r.length){r.shift().render()}},getSelectedNodes:function(){return this._selectedNodes},getSelectedNode:function(){return this.getSelectedNodes()[0]||null},removeAllSelectedNodes:function(){var e=this;var t=this._selectedNodes.splice(0);this._selectedNodes=[];this.renderChangedSelection(t);return this.fire("selectionclear")},removeSelectedNodes:function(e){var t=this;var r=this._selectedNodes.slice(0);e=a.isArray(e)?e:[e];e.forEach(function(e){var r;if((r=t._selectedNodes.indexOf(e))===-1)return;t._selectedNodes.splice(r,1)});this.renderChangedSelection(r);return this},select:function(e,t){var r=this.getSelectedNodes().slice(0);if(t){this._selectedNodes=[]}var n=this;e=a.isArray(e)?e:[e];e.forEach(function(e){if(n._selectedNodes.indexOf(e)!==-1)return;n._selectedNodes.unshift(e)});this.renderChangedSelection(r);return this},selectById:function(e,t){e=a.isArray(e)?e:[e];var r=this.getNodesById(e);return this.select(r,t)},toggleSelect:function(e){if(a.isArray(e)){e.forEach(this.toggleSelect.bind(this))}else{if(e.isSelected())this.removeSelectedNodes(e);else this.select(e)}return this},isSingleSelect:function(){return this._selectedNodes.length==1},getSelectedAncestors:function(e){var t=this.getSelectedNodes().slice(0),r=[],n;var i=t.indexOf(this.getRoot());if(~i&&!e){t.splice(i,1)}function a(e,t){for(var r=e.length-1;r>=0;--r){if(e[r].isAncestorOf(t))return true}return false}t.sort(function(e,t){return e.getLevel()-t.getLevel()});while(n=t.pop()){if(!a(t,n)){r.push(n)}}return r}});i.extendClass(s,{isSelected:function(){var e=this.getMinder();return e&&e.getSelectedNodes().indexOf(this)!=-1}})}};e[29]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(15);var s=e.r(19);var u=e.r(13);function c(e){var t=4096;var r=8192;var n=16384;var i=0;if(typeof e=="string"){e.toLowerCase().split(/\+\s*/).forEach(function(e){switch(e){case"ctrl":case"cmd":i|=t;break;case"alt":i|=r;break;case"shift":i|=n;break;default:i|=o[e]}})}else{if(e.ctrlKey||e.metaKey){i|=t}if(e.altKey){i|=r}if(e.shiftKey){i|=n}i|=e.keyCode}return i}i.extendClass(u,{isShortcutKey:function(e){var t=this.originEvent;if(!t)return false;return c(e)==c(t)}});s.registerInitHook(function(){this._initShortcutKey()});i.extendClass(s,{_initShortcutKey:function(){this._bindShortcutKeys()},_bindShortcutKeys:function(){var e=this._shortcutKeys={};var t="hasOwnProperty";this.on("keydown",function(r){for(var n in e){if(!e[t](n))continue;if(r.isShortcutKey(n)){var i=e[n];if(i.__statusCondition&&i.__statusCondition!=this.getStatus())return;i();r.preventDefault()}}})},addShortcut:function(e,t){var r=this._shortcutKeys;e.split(/\|\s*/).forEach(function(e){var n=e.split("::");var i;if(n.length>1){e=n[1];i=n[0];t.__statusCondition=i}r[e]=t})},addCommandShortcutKeys:function(e,t){var r=this._commandShortcutKeys||(this._commandShortcutKeys={});var n={},i=this;if(t){n[e]=t}else{n=e}var o=this;a.each(n,function(e,t){r[t]=e;o.addShortcut(e,function e(){if(o.queryCommandState(t)!==-1){o.execCommand(t)}})})},getCommandShortcutKey:function(e){var t=this._commandShortcutKeys;return t&&t[e]||null},supportClipboardEvent:function(e){return!!e.ClipboardEvent}(window)})}};e[30]={value:function(t,r,n){var i=e.r(17);var a=e.r(19);var o=~window.location.href.indexOf("status");var s=~window.location.href.indexOf("trace");a.registerInitHook(function(){this._initStatus()});i.extendClass(a,{_initStatus:function(){this._status="normal";this._rollbackStatus="normal"},setStatus:function(e,t){if(this._status=="readonly"&&!t)return this;if(e!=this._status){this._rollbackStatus=this._status;this._status=e;this.fire("statuschange",{lastStatus:this._rollbackStatus,currentStatus:this._status});if(o){console.log(window.event.type,this._rollbackStatus,"->",this._status);if(s){console.trace()}}}return this},rollbackStatus:function(){this.setStatus(this._rollbackStatus)},getRollbackStatus:function(){return this._rollbackStatus},getStatus:function(){return this._status}})}};e[31]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(9);var u=e.r(21);var c=e.r(20);var l={};function h(e,t){l[e]=t}r.register=h;a.extend(o,{getTemplateList:function(){return l}});i.extendClass(o,function(){var e=o.prototype.getTheme;return{useTemplate:function(e,t){this.setTemplate(e);this.refresh(t||800)},getTemplate:function(){return this._template||"default"},setTemplate:function(e){this._template=e||null},getTemplateSupport:function(e){var t=l[this.getTemplate()];return t&&t[e]},getTheme:function(t){var r=this.getTemplateSupport("getTheme")||e;return r.call(this,t)}}}());i.extendClass(u,function(){var e=u.prototype.getLayout;var t=u.prototype.getConnect;return{getLayout:function(){var t=this.getMinder().getTemplateSupport("getLayout")||e;return t.call(this,this)},getConnect:function(){var e=this.getMinder().getTemplateSupport("getConnect")||t;return e.call(this,this)}}}());c.register("TemplateModule",{commands:{template:i.createClass("TemplateCommand",{base:s,execute:function(e,t){e.useTemplate(t)},queryValue:function(e){return e.getTemplate()||"default"}})}})}};e[32]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(20);var c=e.r(9);var l={left:function(e){return 3 in e&&e[3]||1 in e&&e[1]||e[0]},right:function(e){return 1 in e&&e[1]||e[0]},top:function(e){return e[0]},bottom:function(e){return 2 in e&&e[2]||e[0]}};var h={};function d(e,t){h[e]=t}r.register=d;a.extend(o,{getThemeList:function(){return h}});i.extendClass(o,{useTheme:function(e){this.setTheme(e);this.refresh(800);return true},setTheme:function(e){if(e&&!h[e])throw new Error("Theme "+e+" not exists!");var t=this._theme;this._theme=e||null;var r=this.getRenderTarget();if(r){r.classList.remove("km-theme-"+t);if(e){r.classList.add("km-theme-"+e)}r.style.background=this.getStyle("background")}this.fire("themechange",{theme:e});return this},getTheme:function(e){return this._theme||this.getOption("defaultTheme")||"fresh-blue"},getThemeItems:function(e){var t=this.getTheme(e);return h[this.getTheme(e)]},getStyle:function(e,t){var r=this.getThemeItems(t);var n,i,o,s,u;if(e in r)return r[e];n=e.split("-");if(n.length<2)return null;i=n.pop();e=n.join("-");if(e in r){s=r[e];if(a.isArray(s)&&(u=l[i])){return u(s)}if(!isNaN(s))return s}return null},getNodeStyle:function(e,t){var r=this.getStyle(e.getType()+"-"+t,e);return r!==null?r:this.getStyle(t,e)}});i.extendClass(s,{getStyle:function(e){return this.getMinder().getNodeStyle(this,e)}});u.register("Theme",{defaultOptions:{defaultTheme:"fresh-blue"},commands:{theme:i.createClass("ThemeCommand",{base:c,execute:function(e,t){return e.useTheme(t)},queryValue:function(e){return e.getTheme()||"default"}})}});o.registerInitHook(function(){this.setTheme()})}};e[33]={value:function(t,r){var n=e.r(17);var i={};r.extend=n.Utils.extend.bind(n.Utils);r.each=n.Utils.each.bind(n.Utils);r.uuid=function(e){i[e]=i[e]?i[e]+1:1;return e+i[e]};r.guid=function(){return(+new Date*1e6+Math.floor(Math.random()*1e6)).toString(36)};r.trim=function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")};r.keys=function(e){var t=[];for(var r in e){if(e.hasOwnProperty(r)){t.push(r)}}return t};r.clone=function(e){return JSON.parse(JSON.stringify(e))};r.comparePlainObject=function(e,t){return JSON.stringify(e)==JSON.stringify(t)};r.encodeHtml=function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(e,t){if(t){return e}else{return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}}):""};r.clearWhiteSpace=function(e){return e.replace(/[\u200b\t\r\n]/g,"")};r.each(["String","Function","Array","Number","RegExp","Object"],function(e){var t=Object.prototype.toString;r["is"+e]=function(r){return t.apply(r)=="[object "+e+"]"}})}};e[34]={value:function(t,r,n){n.exports=window.kityminder=e.r(35)}};e[35]={value:function(t,r,n){var i={version:e.r(19).version};e.r(33);i.Minder=e.r(19);i.Command=e.r(9);i.Node=e.r(21);e.r(22);e.r(8);i.Event=e.r(13);i.data=e.r(12);e.r(10);i.KeyMap=e.r(15);e.r(29);e.r(30);e.r(23);e.r(28);e.r(14);e.r(16);i.Module=e.r(20);e.r(26);i.Render=e.r(27);i.Connect=e.r(11);i.Layout=e.r(18);i.Theme=e.r(32);i.Template=e.r(31);i.Promise=e.r(25);e.r(7);e.r(24);e.r(42);e.r(43);e.r(44);e.r(45);e.r(46);e.r(47);e.r(48);e.r(49);e.r(50);e.r(51);e.r(52);e.r(53);e.r(54);e.r(55);e.r(56);e.r(57);e.r(58);e.r(59);e.r(60);e.r(61);e.r(62);e.r(63);e.r(67);e.r(64);e.r(66);e.r(65);e.r(40);e.r(36);e.r(37);e.r(38);e.r(39);e.r(41);e.r(74);e.r(77);e.r(76);e.r(75);e.r(77);e.r(79);e.r(78);e.r(0);e.r(1);e.r(2);e.r(3);e.r(4);e.r(5);e.r(6);e.r(68);e.r(72);e.r(69);e.r(71);e.r(70);e.r(73);n.exports=i}};e[36]={value:function(t,r,n){var i=e.r(17);var a=e.r(18);["left","right","top","bottom"].forEach(o);function o(e){var t=e=="left"||e=="right"?"x":"y";var r=e=="left"||e=="top"?-1:1;var n={left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"};function o(e){var r=[];var n=e.getLayoutBox();var a=5;if(t=="x"){r.push({type:"up",node:e,area:new i.Box({x:n.x,y:n.top-e.getStyle("margin-top")-a,width:n.width,height:e.getStyle("margin-top")}),path:["M",n.x,n.top-a,"L",n.right,n.top-a]});r.push({type:"down",node:e,area:new i.Box({x:n.x,y:n.bottom+a,width:n.width,height:e.getStyle("margin-bottom")}),path:["M",n.x,n.bottom+a,"L",n.right,n.bottom+a]})}else{r.push({type:"up",node:e,area:new i.Box({x:n.left-e.getStyle("margin-left")-a,y:n.top,width:e.getStyle("margin-left"),height:n.height}),path:["M",n.left-a,n.top,"L",n.left-a,n.bottom]});r.push({type:"down",node:e,area:new i.Box({x:n.right+a,y:n.top,width:e.getStyle("margin-right"),height:n.height}),path:["M",n.right+a,n.top,"L",n.right+a,n.bottom]})}return r}a.register(e,i.createClass({base:a,doLayout:function(a,o){var s=a.getContentBox();if(t=="x"){a.setVertexOut(new i.Point(s[e],s.cy));a.setLayoutVectorOut(new i.Vector(r,0))}else{a.setVertexOut(new i.Point(s.cx,s[e]));a.setLayoutVectorOut(new i.Vector(0,r))}if(!o.length){return false}o.forEach(function(a){var o=a.getContentBox();a.setLayoutTransform(new i.Matrix);if(t=="x"){a.setVertexIn(new i.Point(o[n[e]],o.cy));a.setLayoutVectorIn(new i.Vector(r,0))}else{a.setVertexIn(new i.Point(o.cx,o[n[e]]));a.setLayoutVectorIn(new i.Vector(0,r))}});this.align(o,n[e]);this.stack(o,n[t]);var u=this.getBranchBox(o);var c=0,l=0;if(t=="x"){c=s[e];c+=r*a.getStyle("margin-"+e);c+=r*o[0].getStyle("margin-"+n[e]);l=s.bottom;l-=s.height/2;l-=u.height/2;l-=u.y}else{c=s.right;c-=s.width/2;c-=u.width/2;c-=u.x;l=s[e];l+=r*a.getStyle("margin-"+e);l+=r*o[0].getStyle("margin-"+n[e])}this.move(o,c,l)},getOrderHint:o}))}}};e[37]={value:function(t,r,n){var i=e.r(17);var a=e.r(18);[-1,1].forEach(o);function o(e){var t="filetree-"+(e>0?"down":"up");a.register(t,i.createClass({base:a,doLayout:function(t,r,n){var a=t.getContentBox();var o=20;t.setVertexOut(new i.Point(a.left+o,e>0?a.bottom:a.top));t.setLayoutVectorOut(new i.Vector(0,e));if(!r.length)return;r.forEach(function(e){var t=e.getContentBox();e.setLayoutTransform(new i.Matrix);e.setVertexIn(new i.Point(t.left,t.cy));e.setLayoutVectorIn(new i.Vector(1,0))});this.align(r,"left");this.stack(r,"y");var s=0;s+=a.left;s+=o;s+=r[0].getStyle("margin-left");var u=0;if(e>0){u+=a.bottom;u+=t.getStyle("margin-bottom");u+=r[0].getStyle("margin-top")}else{u-=this.getTreeBox(r).bottom;u+=a.top;u-=t.getStyle("margin-top");u-=r[0].getStyle("margin-bottom")}this.move(r,s,u)},getOrderHint:function(e){var t=[];var r=e.getLayoutBox();var n=e.getLevel()>1?3:5;t.push({type:"up",node:e,area:new i.Box({x:r.x,y:r.top-e.getStyle("margin-top")-n,width:r.width,height:e.getStyle("margin-top")}),path:["M",r.x,r.top-n,"L",r.right,r.top-n]});t.push({type:"down",node:e,area:new i.Box({x:r.x,y:r.bottom+n,width:r.width,height:e.getStyle("margin-bottom")}),path:["M",r.x,r.bottom+n,"L",r.right,r.bottom+n]});return t}}))}}};e[38]={value:function(t,r,n){var i=e.r(17);var a=e.r(18);a.register("fish-bone-master",i.createClass("FishBoneMasterLayout",{base:a,doLayout:function(e,t,r){var n=[],a=[];var o=t[0];var s=e.getContentBox();e.setVertexOut(new i.Point(s.right,s.cy));e.setLayoutVectorOut(new i.Vector(1,0));if(!o)return;var u=o.getContentBox();var c=e.getStyle("margin-right");var l=o.getStyle("margin-left");var h=o.getStyle("margin-top");var d=o.getStyle("margin-bottom");t.forEach(function(e,t){e.setLayoutTransform(new i.Matrix);var r=e.getContentBox();if(t%2){a.push(e);e.setVertexIn(new i.Point(r.left,r.top));e.setLayoutVectorIn(new i.Vector(1,1))}else{n.push(e);e.setVertexIn(new i.Point(r.left,r.bottom));e.setLayoutVectorIn(new i.Vector(1,-1))}});this.stack(n,"x");this.stack(a,"x");this.align(n,"bottom");this.align(a,"top");var f=s.right+c+l;var g=s.cy-d-e.getStyle("margin-top");var v=s.cy+h+e.getStyle("margin-bottom");this.move(n,f,g);this.move(a,f+l,v)}}))}};e[39]={value:function(t,r,n){var i=e.r(17);var a=e.r(18);a.register("fish-bone-slave",i.createClass("FishBoneSlaveLayout",{base:a,doLayout:function(e,t,r){var n=this;var a=Math.abs;var o=1-.618;var s=e.getContentBox();var u=e.getLayoutVectorIn();e.setLayoutVectorOut(u);var c=s.left+s.width*o;var l=new i.Point(c,u.y>0?s.bottom:s.top);e.setVertexOut(l);var h=t[0];if(!h)return;var d=h.getContentBox();t.forEach(function(e,t){e.setLayoutTransform(new i.Matrix);e.setLayoutVectorIn(new i.Vector(1,0));e.setVertexIn(new i.Point(d.left,d.cy))});this.stack(t,"y");this.align(t,"left");var f=0,g=0;f+=l.x;if(e.getLayoutVectorOut().y<0){g-=this.getTreeBox(t).bottom;g+=e.getContentBox().top;g-=e.getStyle("margin-top");g-=h.getStyle("margin-bottom")}else{g+=e.getContentBox().bottom;g+=e.getStyle("margin-bottom");g+=h.getStyle("margin-top")}this.move(t,f,g);if(r==2){t.forEach(function(e){var t=e.getLayoutTransform();var r=e.getContentBox();var o=t.transformPoint(new i.Point(r.left,0));n.move([e],a(o.y-l.y),0)})}}}))}};e[40]={value:function(t,r,n){var i=e.r(17);var a=e.r(18);var o=e.r(19);a.register("mind",i.createClass({base:a,doLayout:function(e,t){var r=this;var n=Math.ceil(e.children.length/2);var a=[];var s=[];t.forEach(function(e){if(e.getIndex()<n)a.push(e);else s.push(e)});var u=o.getLayoutInstance("left");var c=o.getLayoutInstance("right");u.doLayout(e,s);c.doLayout(e,a);var l=e.getContentBox();e.setVertexOut(new i.Point(l.cx,l.cy));e.setLayoutVectorOut(new i.Vector(0,0))},getOrderHint:function(e){var t=[];var r=e.getLayoutBox();var n=5;t.push({type:"up",node:e,area:new i.Box({x:r.x,y:r.top-e.getStyle("margin-top")-n,width:r.width,height:e.getStyle("margin-top")}),path:["M",r.x,r.top-n,"L",r.right,r.top-n]});t.push({type:"down",node:e,area:new i.Box({x:r.x,y:r.bottom+n,width:r.width,height:e.getStyle("margin-bottom")}),path:["M",r.x,r.bottom+n,"L",r.right,r.bottom+n]});return t}}))}};e[41]={value:function(t,r,n){var i=e.r(17);var a=e.r(18);var o=e.r(19);a.register("tianpan",i.createClass({base:a,doLayout:function(e,t){if(t.length==0)return;var r=this;var n=e.getContentBox();var a,o,s;var u=5;var c=Math.max(n.width,50);t.forEach(function(e,t){e.setLayoutTransform(new i.Matrix);s=r.getTreeBox(e);c=Math.max(Math.max(s.width,s.height),c)});c=c/1.5/Math.PI;t.forEach(function(e,t){a=c*(Math.cos(u)+Math.sin(u)*u);o=c*(Math.sin(u)-Math.cos(u)*u);u+=.9-t*.02;e.setLayoutVectorIn(new i.Vector(1,0));e.setVertexIn(new i.Point(n.cx,n.cy));e.setLayoutTransform(new i.Matrix);r.move([e],a,o)})},getOrderHint:function(e){var t=[];var r=e.getLayoutBox();var n=5;t.push({type:"up",node:e,area:{x:r.x,y:r.top-e.getStyle("margin-top")-n,width:r.width,height:e.getStyle("margin-top")},path:["M",r.x,r.top-n,"L",r.right,r.top-n]});t.push({type:"down",node:e,area:{x:r.x,y:r.bottom+n,width:r.width,height:e.getStyle("margin-bottom")},path:["M",r.x,r.bottom+n,"L",r.right,r.bottom+n]});return t}}))}};e[42]={value:function(t,r,n){var i=e.r(17);var a=e.r(21);var o=e.r(9);var s=e.r(20);i.extendClass(a,{arrange:function(e){var t=this.parent;if(!t)return;var r=t.children;if(e<0||e>=r.length)return;r.splice(this.getIndex(),1);r.splice(e,0,this);return this}});function u(e,t){return e.getIndex()-t.getIndex()}function c(e,t){return-u(e,t)}function l(e){var t=e.getSelectedNode();return t&&t.parent&&t.parent.children.length>1}var h=i.createClass("ArrangeUpCommand",{base:o,execute:function(e){var t=e.getSelectedNodes();t.sort(u);var r=t.map(function(e){return e.getIndex()});t.forEach(function(e,t){e.arrange(r[t]-1)});e.layout(300)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}});var d=i.createClass("ArrangeUpCommand",{base:o,execute:function(e){var t=e.getSelectedNodes();t.sort(c);var r=t.map(function(e){return e.getIndex()});t.forEach(function(e,t){e.arrange(r[t]+1)});e.layout(300)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}});var f=i.createClass("ArrangeCommand",{base:o,execute:function(e,t){var r=e.getSelectedNodes().slice();if(!r.length)return;var n=a.getCommonAncestor(r);if(n!=r[0].parent)return;var i=r.map(function(e){return{index:e.getIndex(),node:e}});var o=Math.min.apply(Math,i.map(function(e){return e.index}))>=t;i.sort(function(e,t){return o?t.index-e.index:e.index-t.index});i.forEach(function(e){e.node.arrange(t)});e.layout(300)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}});s.register("ArrangeModule",{commands:{arrangeup:h,arrangedown:d,arrange:f},contextmenu:[{command:"arrangeup"},{command:"arrangedown"},{divider:true}],commandShortcutKeys:{arrangeup:"normal::alt+Up",arrangedown:"normal::alt+Down"}})}};e[43]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(60);c.register("basestylemodule",function(){var e=this;function t(e,t){return e.getData(t)||e.getStyle(t)}l.registerStyleHook(function(e,r){var n=t(e,"font-weight");var i=t(e,"font-style");var a=[n,i].join("/");r.eachItem(function(e,t){t.setFont({weight:n,style:i})})});return{commands:{bold:i.createClass("boldCommand",{base:u,execute:function(e){var t=e.getSelectedNodes();if(this.queryState("bold")==1){t.forEach(function(e){e.setData("font-weight").render()})}else{t.forEach(function(e){e.setData("font-weight","bold").render()})}e.layout()},queryState:function(){var t=e.getSelectedNodes(),r=0;if(t.length===0){return-1}t.forEach(function(e){if(e&&e.getData("font-weight")){r=1;return false}});return r}}),italic:i.createClass("italicCommand",{base:u,execute:function(e){var t=e.getSelectedNodes();if(this.queryState("italic")==1){t.forEach(function(e){e.setData("font-style").render()})}else{t.forEach(function(e){e.setData("font-style","italic").render()})}e.layout()},queryState:function(){var t=e.getSelectedNodes(),r=0;if(t.length===0){return-1}t.forEach(function(e){if(e&&e.getData("font-style")){r=1;return false}});return r}})},commandShortcutKeys:{bold:"ctrl+b",italic:"ctrl+i"}}})}};e[44]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(21);var s=e.r(9);var u=e.r(20);u.register("ClipboardModule",function(){var e=this,t=[],r=[];function n(t,i){r.push(i);e.appendNode(i,t);i.render();i.setLayoutOffset(null);var a=i.children.map(function(e){return e.clone()});i.clearChildren();for(var o=0,s;s=a[o];o++){n(i,s)}}function a(e){if(!e.length)return;e.sort(function(e,t){return e.getIndex()-t.getIndex()});t=e.map(function(e){return e.clone()})}var u=i.createClass("CopyCommand",{base:s,execute:function(e){a(e.getSelectedAncestors(true));this.setContentChanged(false)}});var c=i.createClass("CutCommand",{base:s,execute:function(e){var t=e.getSelectedAncestors();if(t.length===0)return;a(t);e.select(o.getCommonAncestor(t),true);t.slice().forEach(function(t){e.removeNode(t)});e.layout(300)}});var l=i.createClass("PasteCommand",{base:s,execute:function(e){if(t.length){var i=e.getSelectedNodes();if(!i.length)return;for(var a=0,o;o=t[a];a++){for(var s=0,u;u=i[s];s++){n(u,o.clone())}}e.select(r,true);r=[];e.layout(300)}},queryState:function(e){return e.getSelectedNode()?0:-1}});if(e.supportClipboardEvent&&!i.Browser.gecko){var h=function(e){this.fire("beforeCopy",e)};var d=function(e){this.fire("beforeCut",e)};var f=function(e){this.fire("beforePaste",e)};return{commands:{copy:u,cut:c,paste:l},clipBoardEvents:{copy:h.bind(e),cut:d.bind(e),paste:f.bind(e)},sendToClipboard:a}}else{return{commands:{copy:u,cut:c,paste:l},commandShortcutKeys:{copy:"normal::ctrl+c|",cut:"normal::ctrl+x",paste:"normal::ctrl+v"},sendToClipboard:a}}})}};e[45]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(21);var s=e.r(9);var u=e.r(20);var c=i.createClass("MoveToParentCommand",{base:s,execute:function(e,t,r){var n;for(var i=t.length-1;i>=0;i--){n=t[i];if(n.parent){n.parent.removeChild(n);r.appendChild(n);n.render()}}r.expand();e.select(t,true)}});var l=i.createClass("DropHinter",{base:i.Group,constructor:function(){this.callBase();this.rect=new i.Rect;this.addShape(this.rect)},render:function(e){this.setVisible(!!e);if(e){this.rect.setBox(e.getLayoutBox()).setRadius(e.getStyle("radius")||0).stroke(e.getStyle("drop-hint-color")||"yellow",e.getStyle("drop-hint-width")||2);this.bringTop()}}});var h=i.createClass("OrderHinter",{base:i.Group,constructor:function(){this.callBase();this.area=new i.Rect;this.path=new i.Path;this.addShapes([this.area,this.path])},render:function(e){this.setVisible(!!e);if(e){this.area.setBox(e.area);this.area.fill(e.node.getStyle("order-hint-area-color")||"rgba(0, 255, 0, .5)");this.path.setPathData(e.path);this.path.stroke(e.node.getStyle("order-hint-path-color")||"#0f0",e.node.getStyle("order-hint-path-width")||1)}}});var d=i.createClass("TreeDragger",{constructor:function(e){this._minder=e;this._dropHinter=new l;this._orderHinter=new h;e.getRenderContainer().addShapes([this._dropHinter,this._orderHinter])},dragStart:function(e){this._startPosition=e},dragMove:function(e){var t=10;if(!this._startPosition)return;var r=i.Vector.fromPoints(this._dragPosition||this._startPosition,e);var n=this._minder;this._dragPosition=e;if(!this._dragMode){if(i.Vector.fromPoints(this._dragPosition,this._startPosition).length()<t){return}if(!this._enterDragMode()){return}}for(var a=0;a<this._dragSources.length;a++){this._dragSources[a].setLayoutOffset(this._dragSources[a].getLayoutOffset().offset(r));n.applyLayoutResult(this._dragSources[a])}if(!this._dropTest()){this._orderTest()}else{this._renderOrderHint(this._orderSucceedHint=null)}},dragEnd:function(){this._startPosition=null;this._dragPosition=null;if(!this._dragMode){return}this._fadeDragSources(1);if(this._dropSucceedTarget){this._dragSources.forEach(function(e){e.setLayoutOffset(null)});this._minder.layout(-1);this._minder.execCommand("movetoparent",this._dragSources,this._dropSucceedTarget)}else if(this._orderSucceedHint){var e=this._orderSucceedHint;var t=e.node.getIndex();var r=this._dragSources.map(function(e){e.setLayoutOffset(null);return e.getIndex()});var n=Math.max.apply(Math,r);var i=Math.min.apply(Math,r);if(t<i&&e.type=="down")t++;if(t>n&&e.type=="up")t--;e.node.setLayoutOffset(null);this._minder.execCommand("arrange",t);this._renderOrderHint(null)}else{this._minder.fire("savescene")}this._minder.layout(300);this._leaveDragMode();this._minder.fire("contentchange")},_enterDragMode:function(){this._calcDragSources();if(!this._dragSources.length){this._startPosition=null;return false}this._fadeDragSources(.5);this._calcDropTargets();this._calcOrderHints();this._dragMode=true;this._minder.setStatus("dragtree");return true},_calcDragSources:function(){this._dragSources=this._minder.getSelectedAncestors()},_fadeDragSources:function(e){var t=this._minder;this._dragSources.forEach(function(r){r.getRenderContainer().setOpacity(e,200);r.traverse(function(r){if(e<1){t.detachNode(r)}else{t.attachNode(r)}},true)})},_calcDropTargets:function(){function e(t,r){var n=[],i;n.push(r);r.getChildren().forEach(function(r){for(i=0;i<t.length;i++){if(t[i]==r)return}n=n.concat(e(t,r))});return n}this._dropTargets=e(this._dragSources,this._minder.getRoot());
this._dropTargetBoxes=this._dropTargets.map(function(e){return e.getLayoutBox()})},_calcOrderHints:function(){var e=this._dragSources;var t=o.getCommonAncestor(e);if(t==e[0])t=e[0].parent;if(e.length===0||t!=e[0].parent){this._orderHints=[];return}var r=t.children;this._orderHints=r.reduce(function(t,r){if(e.indexOf(r)==-1){t=t.concat(r.getOrderHint())}return t},[])},_leaveDragMode:function(){this._dragMode=false;this._dropSucceedTarget=null;this._orderSucceedHint=null;this._renderDropHint(null);this._renderOrderHint(null);this._minder.rollbackStatus()},_drawForDragMode:function(){this._text.setContent(this._dragSources.length+" items");this._text.setPosition(this._startPosition.x,this._startPosition.y+5);this._minder.getRenderContainer().addShape(this)},_boxTest:function(e,t,r){var n=this._dragSources.map(function(e){return e.getLayoutBox()});var i,a,o,s,u;r=r||function(e,t,r){return e&&!e.isEmpty()};for(i=0;i<e.length;i++){o=e[i];u=t.call(this,o,i);for(a=0;a<n.length;a++){s=n[a];var c=s.intersect(u);if(r(c,s,u)){return o}}}return null},_dropTest:function(){this._dropSucceedTarget=this._boxTest(this._dropTargets,function(e,t){return this._dropTargetBoxes[t]},function(e,t,r){function n(e){return e.width*e.height}if(!e)return false;if(!n(e))return false;if(n(e)>.5*Math.min(n(t),n(r)))return true;if(e.width+1>=Math.min(t.width,r.width))return true;if(e.height+1>=Math.min(t.height,r.height))return true;return false});this._renderDropHint(this._dropSucceedTarget);return!!this._dropSucceedTarget},_orderTest:function(){this._orderSucceedHint=this._boxTest(this._orderHints,function(e){return e.area});this._renderOrderHint(this._orderSucceedHint);return!!this._orderSucceedHint},_renderDropHint:function(e){this._dropHinter.render(e)},_renderOrderHint:function(e){this._orderHinter.render(e)},preventDragMove:function(){this._startPosition=null}});u.register("DragTree",function(){var e;return{init:function(){e=new d(this);window.addEventListener("mouseup",function(){e.dragEnd()})},events:{"normal.mousedown inputready.mousedown":function(t){if(t.originEvent.button)return;if(t.getTargetNode()&&t.getTargetNode()!=this.getRoot()){e.dragStart(t.getPosition())}},"normal.mousemove dragtree.mousemove":function(t){e.dragMove(t.getPosition())},"normal.mouseup dragtree.beforemouseup":function(t){e.dragEnd();t.preventDefault()},statuschange:function(t){if(t.lastStatus=="textedit"&&t.currentStatus=="normal"){e.preventDragMove()}}},commands:{movetoparent:c}}})}};e[46]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(15);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("Expand",function(){var e=this;var t="expandState",r="expand",n="collapse";i.extendClass(s,{expand:function(){this.setData(t,r);return this},collapse:function(){this.setData(t,n);return this},isExpanded:function(){var e=this.getData(t)!==n;return e&&(this.isRoot()||this.parent.isExpanded())},isCollapsed:function(){return!this.isExpanded()}});var c=i.createClass("ExpandCommand",{base:u,execute:function(e,t){var r=e.getSelectedNode();if(!r)return;if(t){r=r.parent}while(r.parent){r.expand();r=r.parent}r.renderTree();e.layout(100)},queryState:function(e){var t=e.getSelectedNode();return t&&!t.isRoot()&&!t.isExpanded()?0:-1}});var h=i.createClass("ExpandToLevelCommand",{base:u,execute:function(e,t){e.getRoot().traverse(function(e){if(e.getLevel()<t)e.expand();if(e.getLevel()==t&&!e.isLeaf())e.collapse()});e.refresh(100)},enableReadOnly:true});var d=i.createClass("CollapseCommand",{base:u,execute:function(e){var t=e.getSelectedNode();if(!t)return;t.collapse();t.renderTree();e.layout()},queryState:function(e){var t=e.getSelectedNode();return t&&!t.isRoot()&&t.isExpanded()?0:-1}});var f=i.createClass("Expander",{base:i.Group,constructor:function(e){this.callBase();this.radius=6;this.outline=new i.Circle(this.radius).stroke("gray").fill("white");this.sign=(new i.Path).stroke("gray");this.addShapes([this.outline,this.sign]);this.initEvent(e);this.setId(a.uuid("node_expander"));this.setStyle("cursor","pointer")},initEvent:function(t){this.on("mousedown",function(r){e.select([t],true);if(t.isExpanded()){t.collapse()}else{t.expand()}t.renderTree().getMinder().layout(100);t.getMinder().fire("contentchange");r.stopPropagation();r.preventDefault()});this.on("dblclick click mouseup",function(e){e.stopPropagation();e.preventDefault()})},setState:function(e){if(e=="hide"){this.setVisible(false);return}this.setVisible(true);var t=["M",1.5-this.radius,0,"L",this.radius-1.5,0];if(e==n){t.push(["M",0,1.5-this.radius,"L",0,this.radius-1.5])}this.sign.setPathData(t)}});var g=i.createClass("ExpanderRenderer",{base:l,create:function(e){if(e.isRoot())return;this.expander=new f(e);e.getRenderContainer().prependShape(this.expander);e.expanderRenderer=this;this.node=e;return this.expander},shouldRender:function(e){return!e.isRoot()},update:function(e,r,n){if(!r.parent)return;var i=r.parent.isExpanded();e.setState(i&&r.children.length?r.getData(t):"hide");var a=r.getLayoutVectorIn().normalize(e.radius+r.getStyle("stroke-width"));var o=r.getVertexIn().offset(a.reverse());this.expander.setTranslate(o)}});return{commands:{expand:c,expandtolevel:h,collapse:d},events:{layoutapply:function(e){var t=e.node.getRenderer("ExpanderRenderer");if(t.getRenderShape()){t.update(t.getRenderShape(),e.node)}},beforerender:function(e){var t=e.node;var r=!t.parent||t.parent.isExpanded();var n=this;t.getRenderContainer().setVisible(r);if(!r)e.stopPropagation()},"normal.keydown":function(e){if(this.getStatus()=="textedit")return;if(e.originEvent.keyCode==o["/"]){var t=this.getSelectedNode();if(!t||t==this.getRoot())return;var r=t.isExpanded();this.getSelectedNodes().forEach(function(e){if(r)e.collapse();else e.expand();e.renderTree()});this.layout(100);this.fire("contentchange");e.preventDefault();e.stopPropagationImmediately()}if(e.isShortcutKey("Alt+`")){this.execCommand("expandtolevel",9999)}for(var n=1;n<6;n++){if(e.isShortcutKey("Alt+"+n)){this.execCommand("expandtolevel",n)}}}},renderers:{outside:g},contextmenu:[{command:"expandtoleaf",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",9999)}},{command:"expandtolevel1",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",1)}},{command:"expandtolevel2",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",2)}},{command:"expandtolevel3",query:function(){return!e.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",3)}},{divider:true}]}})}};e[47]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(60);function h(e,t){return e.getData(t)||e.getStyle(t)}l.registerStyleHook(function(e,t){var r=e.getData("color");var n=e.getStyle("selected-color");var i=e.getStyle("color");var a=r||(e.isSelected()&&n?n:i);var o=h(e,"font-family");var s=h(e,"font-size");t.fill(a);t.eachItem(function(e,t){t.setFont({family:o,size:s})})});c.register("fontmodule",{commands:{forecolor:i.createClass("fontcolorCommand",{base:u,execute:function(e,t){var r=e.getSelectedNodes();r.forEach(function(e){e.setData("color",t);e.render()})},queryState:function(e){return e.getSelectedNodes().length===0?-1:0},queryValue:function(e){if(e.getSelectedNodes().length==1){return e.getSelectedNodes()[0].getData("color")}return"mixed"}}),background:i.createClass("backgroudCommand",{base:u,execute:function(e,t){var r=e.getSelectedNodes();r.forEach(function(e){e.setData("background",t);e.render()})},queryState:function(e){return e.getSelectedNodes().length===0?-1:0},queryValue:function(e){if(e.getSelectedNodes().length==1){return e.getSelectedNodes()[0].getData("background")}return"mixed"}}),fontfamily:i.createClass("fontfamilyCommand",{base:u,execute:function(e,t){var r=e.getSelectedNodes();r.forEach(function(r){r.setData("font-family",t);r.render();e.layout()})},queryState:function(e){return e.getSelectedNodes().length===0?-1:0},queryValue:function(e){var t=e.getSelectedNode();if(t)return t.getData("font-family");return null}}),fontsize:i.createClass("fontsizeCommand",{base:u,execute:function(e,t){var r=e.getSelectedNodes();r.forEach(function(r){r.setData("font-size",t);r.render();e.layout(300)})},queryState:function(e){return e.getSelectedNodes().length===0?-1:0},queryValue:function(e){var t=e.getSelectedNode();if(t)return t.getData("font-size");return null}})}})}};e[48]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);var h="M16.614,10.224h-1.278c-1.668,0-3.07-1.07-3.599-2.556h4.877c0.707,0,1.278-0.571,1.278-1.278V3.834 c0-0.707-0.571-1.278-1.278-1.278h-4.877C12.266,1.071,13.668,0,15.336,0h1.278c2.116,0,3.834,1.716,3.834,3.834V6.39 C20.448,8.508,18.73,10.224,16.614,10.224z M5.112,5.112c0-0.707,0.573-1.278,1.278-1.278h7.668c0.707,0,1.278,0.571,1.278,1.278 S14.765,6.39,14.058,6.39H6.39C5.685,6.39,5.112,5.819,5.112,5.112z M2.556,3.834V6.39c0,0.707,0.573,1.278,1.278,1.278h4.877 c-0.528,1.486-1.932,2.556-3.599,2.556H3.834C1.716,10.224,0,8.508,0,6.39V3.834C0,1.716,1.716,0,3.834,0h1.278 c1.667,0,3.071,1.071,3.599,2.556H3.834C3.129,2.556,2.556,3.127,2.556,3.834z";c.register("hyperlink",{commands:{hyperlink:i.createClass("hyperlink",{base:u,execute:function(e,t,r){var n=e.getSelectedNodes();n.forEach(function(e){e.setData("hyperlink",t);e.setData("hyperlinkTitle",t&&r);e.render()});e.layout()},queryState:function(e){var t=e.getSelectedNodes(),r=0;if(t.length===0){return-1}t.forEach(function(e){if(e&&e.getData("hyperlink")){r=0;return false}});return r},queryValue:function(e){var t=e.getSelectedNode();return{url:t.getData("hyperlink"),title:t.getData("hyperlinkTitle")}}})},renderers:{right:i.createClass("hyperlinkrender",{base:l,create:function(){var e=new i.HyperLink;var t=new i.Path;var r=new i.Rect(24,22,-2,-6,4).fill("rgba(255, 255, 255, 0)");t.setPathData(h).fill("#666");e.addShape(r);e.addShape(t);e.setTarget("_blank");e.setStyle("cursor","pointer");e.on("mouseover",function(){r.fill("rgba(255, 255, 200, .8)")}).on("mouseout",function(){r.fill("rgba(255, 255, 255, 0)")});return e},shouldRender:function(e){return e.getData("hyperlink")},update:function(e,t,r){var n=t.getData("hyperlink");e.setHref(n);var a=t.getData("hyperlinkTitle");if(a){a=[a,"(",n,")"].join("")}else{a=n}e.node.setAttributeNS("http://www.w3.org/1999/xlink","title",a);var o=t.getStyle("space-right");e.setTranslate(r.right+o+2,-5);return new i.Box({x:r.right+o,y:-11,width:24,height:22})}})}})}};e[49]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("image",function(){function e(e,t){var r=document.createElement("img");r.onload=function(){t(r.width,r.height)};r.onerror=function(){t(null)};r.src=e}function t(e,t,r,n){var i=e/t,a=r/n;if(e>r&&i>a){e=r;t=e/i}else if(t>n){t=n;e=t*i}return{width:e|0,height:t|0}}var r=i.createClass("ImageCommand",{base:u,execute:function(r,n,i){var a=r.getSelectedNodes();e(n,function(e,o){a.forEach(function(a){var s=t(e,o,r.getOption("maxImageWidth"),r.getOption("maxImageHeight"));a.setData("image",n);a.setData("imageTitle",n&&i);a.setData("imageSize",n&&s);a.render()});r.fire("saveScene");r.layout(300)})},queryState:function(e){var t=e.getSelectedNodes(),r=0;if(t.length===0){return-1}t.forEach(function(e){if(e&&e.getData("image")){r=0;return false}});return r},queryValue:function(e){var t=e.getSelectedNode();return{url:t.getData("image"),title:t.getData("imageTitle")}}});var n=i.createClass("ImageRenderer",{base:l,create:function(e){return new i.Image(e.getData("image"))},shouldRender:function(e){return e.getData("image")},update:function(e,t,r){var n=t.getData("image");var a=t.getData("imageTitle");var o=t.getData("imageSize");var s=t.getStyle("space-top");if(!o)return;if(a){e.node.setAttributeNS("http://www.w3.org/1999/xlink","title",a)}var u=r.cx-o.width/2;var c=r.y-o.height-s;e.setUrl(n).setX(u|0).setY(c|0).setWidth(o.width|0).setHeight(o.height|0);return new i.Box(u|0,c|0,o.width|0,o.height|0)}});return{defaultOptions:{maxImageWidth:200,maxImageHeight:200},commands:{image:r},renderers:{top:n}}})}};e[50]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(15);var s=e.r(19);var u=e.r(21);var c=e.r(9);var l=e.r(20);var h=e.r(27);l.register("KeyboardModule",function(){var e=Math.min,t=Math.max,r=Math.abs,n=Math.sqrt,i=Math.exp;function a(e){var t=[],r;e.traverse(function(e){r=e.getLayoutBox();if(r.width&&r.height){t.push({left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height,width:r.width,height:r.height,node:e})}});for(var n=0;n<t.length;n++){s(t,n)}}function o(r,i){var a,o,s,u,c,l,h,d,f;a=e(r.left,i.left);o=t(r.right,i.right);s=e(r.top,i.top);u=t(r.bottom,i.bottom);c=o-a-r.width-i.width;l=u-s-r.height-i.height;if(c<0)h=l;else if(l<0)h=c;else h=n(c*c+l*l);var g=r.node;var v=i.node;if(g.parent==v.parent){h/=10}if(v.parent==g){h/=5}return h}function s(e,t){var r=e[t];var n={},i;var a,s;for(var u=0;u<e.length;u++){if(u==t)continue;a=e[u];s=o(a,r);if(a.right<r.left){if(!n.left||s<n.left.dist){n.left={dist:s,node:a.node}}}if(a.left>r.right){if(!n.right||s<n.right.dist){n.right={dist:s,node:a.node}}}if(a.bottom<r.top){if(!n.top||s<n.top.dist){n.top={dist:s,node:a.node}}}if(a.top>r.bottom){if(!n.down||s<n.down.dist){n.down={dist:s,node:a.node}}}}r.node._nearestNodes={right:n.right&&n.right.node||null,top:n.top&&n.top.node||null,left:n.left&&n.left.node||null,down:n.down&&n.down.node||null}}function u(e,t){var r=e.getSelectedNode();if(!r){e.select(e.getRoot());a(e.getRoot());return}if(!r._nearestNodes){a(e.getRoot())}var n=r._nearestNodes[t];if(n){e.select(n,true)}}var c;return{events:{layoutallfinish:function(){var e=this.getRoot();a(e)},"normal.keydown readonly.keydown":function(e){var t=this;["left","right","up","down"].forEach(function(r){if(e.isShortcutKey(r)){u(t,r=="up"?"top":r);e.preventDefault()}})}}}})}};e[51]={value:function(t,r,n){var i=e.r(17);var a=e.r(9);var o=e.r(20);var s=i.createClass("LayoutCommand",{base:a,execute:function(e,t){var r=e.getSelectedNodes();r.forEach(function(e){e.layout(t)})},queryValue:function(e){var t=e.getSelectedNode();if(t){return t.getData("layout")}},queryState:function(e){return e.getSelectedNode()?0:-1}});var u=i.createClass("ResetLayoutCommand",{base:a,execute:function(e){var t=e.getSelectedNodes();if(!t.length)t=[e.getRoot()];t.forEach(function(e){e.traverse(function(e){e.resetLayoutOffset();if(!e.isRoot()){e.setData("layout",null)}})});e.layout(300)},enableReadOnly:true});o.register("LayoutModule",{commands:{layout:s,resetlayout:u},contextmenu:[{command:"resetlayout"},{divider:true}],commandShortcutKeys:{resetlayout:"Ctrl+Shift+L"}})}};e[52]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);var h=i.createClass("AppendChildCommand",{base:u,execute:function(e,t){var r=e.getSelectedNode();if(!r){return null}var n=e.createNode(t,r);e.select(n,true);if(r.isExpanded()){n.render()}else{r.expand();r.renderTree()}e.layout(600)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}});var d=i.createClass("AppendSiblingCommand",{base:u,execute:function(e,t){var r=e.getSelectedNode();var n=r.parent;if(!n){return e.execCommand("AppendChildNode",t)}var i=e.createNode(t,n,r.getIndex()+1);i.setGlobalLayoutTransform(r.getGlobalLayoutTransform());e.select(i,true);i.render();e.layout(600)},queryState:function(e){var t=e.getSelectedNode();return t?0:-1}});var f=i.createClass("RemoverNodeCommand",{base:u,execute:function(e){var t=e.getSelectedNodes();var r=s.getCommonAncestor.apply(null,t);var n=t[0].getIndex();t.forEach(function(t){if(!t.isRoot())e.removeNode(t)});if(t.length==1){var i=r.children[n-1]||r.children[n];e.select(i||r||e.getRoot(),true)}else{e.select(r||e.getRoot(),true)}e.layout(600)},queryState:function(e){var t=e.getSelectedNode();return t&&!t.isRoot()?0:-1}});var g=i.createClass("AppendParentCommand",{base:u,execute:function(e,t){var r=e.getSelectedNodes();r.sort(function(e,t){return e.getIndex()-t.getIndex()});var n=r[0].parent;var i=e.createNode(t,n,r[0].getIndex());r.forEach(function(e){i.appendChild(e)});i.setGlobalLayoutTransform(r[r.length>>1].getGlobalLayoutTransform());e.select(i,true);e.layout(600)},queryState:function(e){var t=e.getSelectedNodes();if(!t.length)return-1;var r=t[0].parent;if(!r)return-1;for(var n=1;n<t.length;n++){if(t[n].parent!=r)return-1}return 0}});c.register("NodeModule",function(){return{commands:{AppendChildNode:h,AppendSiblingNode:d,RemoveNode:f,AppendParentNode:g},commandShortcutKeys:{appendsiblingnode:"normal::Enter",appendchildnode:"normal::Insert|Tab",appendparentnode:"normal::Shift+Tab|normal::Shift+Insert",removenode:"normal::Del|Backspace"}}})}};e[53]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("NoteModule",function(){var e="M9,9H3V8h6L9,9L9,9z M9,7H3V6h6V7z M9,5H3V4h6V5z M8.5,11H2V2h8v7.5 M9,12l2-2V1H1v11";var t=i.createClass("NoteCommand",{base:u,execute:function(e,t){var r=e.getSelectedNode();r.setData("note",t);r.render();r.getMinder().layout(300)},queryState:function(e){return e.getSelectedNodes().length===1?0:-1},queryValue:function(e){var t=e.getSelectedNode();return t&&t.getData("note")}});var r=i.createClass("NoteIcon",{base:i.Group,constructor:function(){this.callBase();this.width=16;this.height=17;this.rect=new i.Rect(16,17,.5,-8.5,2).fill("transparent");this.path=(new i.Path).setPathData(e).setTranslate(2.5,-6.5);this.addShapes([this.rect,this.path]);this.on("mouseover",function(){this.rect.fill("rgba(255, 255, 200, .8)")}).on("mouseout",function(){this.rect.fill("transparent")});this.setStyle("cursor","pointer")}});var n=i.createClass("NoteIconRenderer",{base:l,create:function(e){var t=new r;t.on("mousedown",function(t){t.preventDefault();e.getMinder().fire("editnoterequest")});t.on("mouseover",function(){e.getMinder().fire("shownoterequest",{node:e,icon:t})});t.on("mouseout",function(){e.getMinder().fire("hidenoterequest",{node:e,icon:t})});return t},shouldRender:function(e){return e.getData("note")},update:function(e,t,r){var n=r.left-e.width-t.getStyle("space-left");var a=r.cy;e.path.fill(t.getStyle("color"));e.setTranslate(n,a);return new i.Box(n,Math.round(a-e.height/2),e.width,e.height)}});return{renderers:{left:n},commands:{note:t}}})}};e[54]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);var h=i.createClass("OutlineRenderer",{base:l,create:function(e){var t=(new i.Rect).setId(a.uuid("node_outline"));this.bringToBack=true;return t},update:function(e,t,r){var n=t.getStyle("shape");var a=t.getStyle("padding-left"),o=t.getStyle("padding-right"),s=t.getStyle("padding-top"),u=t.getStyle("padding-bottom");var c={x:r.x-a,y:r.y-s,width:r.width+a+o,height:r.height+s+u};var l=t.getStyle("radius");if(n&&n=="circle"){var h=Math.pow;var d=Math.round;l=d(Math.sqrt(h(c.width,2)+h(c.height,2))/2);c.x=r.cx-l;c.y=r.cy-l;c.width=2*l;c.height=2*l}var f=t.isSelected()?t.getMinder().isFocused()?"selected-":"blur-selected-":"";e.setPosition(c.x,c.y).setSize(c.width,c.height).setRadius(l).fill(t.getData("background")||t.getStyle(f+"background")||t.getStyle("background")).stroke(t.getStyle(f+"stroke"||t.getStyle("stroke")),t.getStyle(f+"stroke-width"));return new i.Box(c)}});var d=i.createClass("ShadowRenderer",{base:l,create:function(e){this.bringToBack=true;return new i.Rect},shouldRender:function(e){return e.getStyle("shadow")},update:function(e,t,r){e.setPosition(r.x+4,r.y+5).fill(t.getStyle("shadow"));var n=t.getStyle("shape");if(!n){e.setSize(r.width,r.height);e.setRadius(t.getStyle("radius"))}else if(n=="circle"){var i=Math.max(r.width,r.height);e.setSize(i,i);e.setRadius(i/2)}}});var f=new i.Marker;f.setWidth(10);f.setHeight(12);f.setRef(0,0);f.setViewBox(-6,-4,8,10);f.addShape((new i.Path).setPathData("M-5-3l5,3,-5,3").stroke("#33ffff"));var g=/wire/.test(window.location.href);var v=i.createClass("WireframeRenderer",{base:l,create:function(){var e=new i.Group;var t=this.oxy=(new i.Path).stroke("#f6f").setPathData("M0,-50L0,50M-50,0L50,0");var r=this.wireframe=(new i.Rect).stroke("lightgreen");var n=this.vectorIn=(new i.Path).stroke("#66ffff");var a=this.vectorOut=(new i.Path).stroke("#66ffff");n.setMarker(f,"end");a.setMarker(f,"end");return e.addShapes([t,r,n,a])},shouldRender:function(){return g},update:function(e,t,r){this.wireframe.setPosition(r.x,r.y).setSize(r.width,r.height);var n=t.getVertexIn();var i=t.getVertexOut();var a=t.getLayoutVectorIn().normalize(30);var o=t.getLayoutVectorOut().normalize(30);this.vectorIn.setPathData(["M",n.offset(a.reverse()),"L",n]);this.vectorOut.setPathData(["M",i,"l",o])}});c.register("OutlineModule",function(){return{events:!g?null:{ready:function(){this.getPaper().addResource(f)},layoutallfinish:function(){this.getRoot().traverse(function(e){e.getRenderer("WireframeRenderer").update(null,e,e.getContentBox())})}},renderers:{outline:h,outside:[d,v]}}})}};e[55]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("PriorityModule",function(){var e=this;var t=[null,["#FF1200","#840023"],["#0074FF","#01467F"],["#00AF00","#006300"],["#FF962E","#B25000"],["#A464FF","#4720C4"],["#A3A3A3","#515151"],["#A3A3A3","#515151"],["#A3A3A3","#515151"],["#A3A3A3","#515151"]];var r="M0,13c0,3.866,3.134,7,7,7h6c3.866,0,7-3.134,7-7V7H0V13z";var n="M20,10c0,3.866-3.134,7-7,7H7c-3.866,0-7-3.134-7-7V7c0-3.866,3.134-7,7-7h6c3.866,0,7,3.134,7,7V10z";var o="priority";var s=i.createClass("PriorityIcon",{base:i.Group,constructor:function(){this.callBase();this.setSize(20);this.create();this.setId(a.uuid("node_priority"))},setSize:function(e){this.width=this.height=e},create:function(){var e,t,a,o;e=(new i.Path).setPathData(n).fill("white");t=(new i.Path).setPathData(r).setTranslate(.5,.5);a=(new i.Path).setPathData(n).setOpacity(.8).setTranslate(.5,.5);o=(new i.Text).setX(this.width/2-.5).setY(this.height/2).setTextAnchor("middle").setVerticalAlign("middle").setFontItalic(true).setFontSize(12).fill("white");this.addShapes([t,a,o]);this.mask=a;this.back=t;this.number=o},setValue:function(e){var r=this.back,n=this.mask,i=this.number;var a=t[e];if(a){r.fill(a[1]);n.fill(a[0])}i.setContent(e)}});var c=i.createClass("SetPriorityCommand",{base:u,execute:function(e,t){var r=e.getSelectedNodes();for(var n=0;n<r.length;n++){r[n].setData(o,t||null).render()}e.layout()},queryValue:function(e){var t=e.getSelectedNodes();var r;for(var n=0;n<t.length;n++){r=t[n].getData(o);if(r)break}return r||null},queryState:function(e){return e.getSelectedNodes().length?0:-1}});return{commands:{priority:c},renderers:{left:i.createClass("PriorityRenderer",{base:l,create:function(e){return new s},shouldRender:function(e){return e.getData(o)},update:function(e,t,r){var n=t.getData(o);var a=t.getStyle("space-left"),s,u;e.setValue(n);s=r.left-e.width-a;u=-e.height/2;e.setTranslate(s,u);return new i.Box({x:s,y:u,width:e.width,height:e.height})}})}}})}};e[56]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("ProgressModule",function(){var e=this;var t="progress";var r="#FFED83";var n="#43BC00";var o="M10,3c4.418,0,8,3.582,8,8h1c0-5.523-3.477-10-9-10S1,5.477,1,11h1C2,6.582,5.582,3,10,3z";var s="#8E8E8E";var c="M10,0C4.477,0,0,4.477,0,10c0,5.523,4.477,10,10,10s10-4.477,10-10C20,4.477,15.523,0,10,0zM10,18c-4.418,0-8-3.582-8-8s3.582-8,8-8s8,3.582,8,8S14.418,18,10,18z";var h=(new i.LinearGradient).pipe(function(e){e.setStartPosition(0,0);e.setEndPosition(0,1);e.addStop(0,"#fff");e.addStop(1,"#ccc")});var d="M15.812,7.896l-6.75,6.75l-4.5-4.5L6.25,8.459l2.812,2.803l5.062-5.053L15.812,7.896z";var f="#EEE";e.getPaper().addResource(h);var g=i.createClass("ProgressIcon",{base:i.Group,constructor:function(e){this.callBase();this.setSize(20);this.create();this.setValue(e);this.setId(a.uuid("node_progress"));this.translate(.5,.5)},setSize:function(e){this.width=this.height=e},create:function(){var e,t,a,u,l;e=new i.Circle(9).fill(r);t=new i.Pie(9,0).fill(n);a=(new i.Path).setPathData(o).setTranslate(-10,-10).fill(s);u=(new i.Path).setTranslate(-10,-10).setPathData(c).fill(h);l=(new i.Path).setTranslate(-10,-10).setPathData(d).fill(f);this.addShapes([e,t,a,l,u]);this.pie=t;this.check=l},setValue:function(e){this.pie.setAngle(-360*(e-1)/8);this.check.setVisible(e==9)}});var v=i.createClass("ProgressCommand",{base:u,execute:function(e,r){var n=e.getSelectedNodes();for(var i=0;i<n.length;i++){n[i].setData(t,r||null).render()}e.layout()},queryValue:function(e){var r=e.getSelectedNodes();var n;for(var i=0;i<r.length;i++){n=r[i].getData(t);if(n)break}return n||null},queryState:function(e){return e.getSelectedNodes().length?0:-1}});return{commands:{progress:v},renderers:{left:i.createClass("ProgressRenderer",{base:l,create:function(e){return new g},shouldRender:function(e){return e.getData(t)},update:function(e,r,n){var a=r.getData(t);var o=r.getStyle("space-left");var s,u;e.setValue(a);s=n.left-e.width-o;u=-e.height/2;e.setTranslate(s+e.width/2,u+e.height/2);return new i.Box(s,u,e.width,e.height)}})}}})}};e[57]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("Resource",function(){var e=function(){var e,t,r,n,i,a,o,s,u,c,l;l=4*(1<<30);e=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];i=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479];c=function(e){if(e<0){e+=l}return("00000000"+e.toString(16)).slice(-8)};a=[[16,50,84,118,152,186,220,254],[174,132,249,109,193,32,123,53],[139,12,37,223,234,99,23,73],[151,19,205,235,98,165,4,143],[9,117,66,250,30,203,134,211],[194,166,176,56,212,87,239,145],[92,241,222,164,112,54,41,184],[189,231,28,147,5,79,104,162],[246,158,59,128,44,125,65,90],[42,72,103,81,191,233,195,13]];o=function(e,t,r){var n=s[e]^s[t];s[e]=n>>>r|n<<32-r};t=function(e,t,c,l,h){var d=n+a[r][e]%16,f=n+(a[r][e]>>4);t%=4;c=4+c%4;l=8+l%4;h=12+h%4;s[t]+=s[c]+(u[d]^i[f%16]);o(h,t,16);s[l]+=s[h];o(c,l,12);s[t]+=s[c]+(u[f]^i[d%16]);o(h,t,8);s[l]+=s[h];o(c,l,7)};return function(a,o){if(!(o instanceof Array&&o.length===4)){o=[0,0,0,0]}var l,h,d,f,g,v,p,m;h=e.slice(0);l=i.slice(0,8);for(r=0;r<4;r+=1){l[r]^=o[r]}d=a.length*16;g=d%512>446||d%512===0?0:d;if(d%512===432){a+="老"}else{a+="耀";while(a.length%32!==27){a+="\0"}a+=""}u=[];for(m=0;m<a.length;m+=2){u.push(a.charCodeAt(m)*65536+a.charCodeAt(m+1))}u.push(0);u.push(d);v=u.length-16;p=0;for(n=0;n<u.length;n+=16){p+=512;f=n===v?g:Math.min(d,p);s=h.concat(l);s[12]^=f;s[13]^=f;for(r=0;r<10;r+=1){for(m=0;m<8;m+=1){if(m<4){t(m,m,m,m,m)}else{t(m,m,m+1,m+2,m+3)}}}for(m=0;m<8;m+=1){h[m]^=o[m%4]^s[m]^s[m+8]}}return h.map(c).join("")}}();var t=[51,303,75,200,157,0,26,254].map(function(e){return i.Color.createHSL(e,100,85)});i.extendClass(o,{getHashCode:function(t){t=e(t);var r=1315423911,n,i;for(n=t.length-1;n>=0;n--){i=t.charCodeAt(n);r^=(r<<5)+i+(r>>2)}return r&2147483647},getResourceColor:function(e){var r=this._getResourceColorIndexMapping();var n;if(!r.hasOwnProperty(e)){n=this._getNextResourceColorIndex();r[e]=n}return t[r[e]]||i.Color.createHSL(Math.floor(this.getHashCode(e)/2147483647*359),100,85)},getUsedResource:function(){var e=this._getResourceColorIndexMapping();var t=[],r;for(r in e){if(e.hasOwnProperty(r)){t.push(r)}}return t},_getNextResourceColorIndex:function(){var e=this._getResourceColorIndexMapping();var r,n,i;n=[];for(r in e){if(e.hasOwnProperty(r)){n.push(e[r])}}for(i=0;i<t.length;i++){if(!~n.indexOf(i))return i}return-1},_getResourceColorIndexMapping:function(){return this._resourceColorMapping||(this._resourceColorMapping={})}});var r=i.createClass("ResourceCommand",{base:u,execute:function(e,t){var r=e.getSelectedNodes();if(typeof t=="string"){t=[t]}r.forEach(function(e){e.setData("resource",t).render()});e.layout(200)},queryValue:function(e){var t=e.getSelectedNodes();var r=[];t.forEach(function(e){var t=e.getData("resource");if(!t)return;t.forEach(function(e){if(!~r.indexOf(e)){r.push(e)}})});return r},queryState:function(e){return e.getSelectedNode()?0:-1}});var n=i.createClass("ResourceOverlay",{base:i.Group,constructor:function(){this.callBase();var e,t;t=this.rect=(new i.Rect).setRadius(4);e=this.text=(new i.Text).setFontSize(12).setVerticalAlign("middle");this.addShapes([t,e]);this.setStyle("cursor","pointer")},setValue:function(e,t){t=i.Color.createHSL(200,100,85);var r=4,n=2,a=4;var o,s,u;o=this.text;if(e==this.lastResourceName){s=this.lastBox}else{o.setContent(e);s=o.getBoundaryBox();this.lastResourceName=e;this.lastBox=s}o.setX(r).fill(t.dec("l",70));u=this.rect;u.setPosition(0,s.y-n);this.width=Math.round(s.width+r*2);this.height=Math.round(s.height+n*2);u.setSize(this.width,this.height);u.fill(t)}});var a=i.createClass("ResourceRenderer",{base:l,create:function(e){this.overlays=[];return new i.Group},shouldRender:function(e){return e.getData("resource")&&e.getData("resource").length},update:function(e,t,r){var a=t.getStyle("space-right");var o=this.overlays;var s=t.getData("resource").filter(function(e){return e!==null});if(s.length===0){return}var u=t.getMinder();var c,l,h;h=0;for(c=0;c<s.length;c++){h+=a;l=o[c];if(!l){l=new n;o.push(l);e.addShape(l)}l.setVisible(true);l.setValue(s[c],u.getResourceColor(s[c]));l.setTranslate(h,-1);h+=l.width}while(l=o[c++])l.setVisible(false);e.setTranslate(r.right,0);return new i.Box({x:r.right,y:Math.round(-o[0].height/2),width:h,height:o[0].height})}});return{commands:{resource:r},renderers:{right:a}}})}};e[58]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("Select",function(){var e=this;var t=e.getRenderContainer();var r=function(){var r=null;var n=new i.Path;var a=false;var o=10;return{selectStart:function(e){if(e.originEvent.button||e.originEvent.altKey)return;if(r){return this.selectEnd()}r=e.getPosition(t).round()},selectMove:function(s){if(e.getStatus()=="textedit"){return}if(!r)return;var u=r,c=s.getPosition(t);if(!a){if(i.Vector.fromPoints(u,c).length()<o){return}a=true;t.addShape(n);n.fill(e.getStyle("marquee-background")).stroke(e.getStyle("marquee-stroke")).setOpacity(.8).getDrawer().clear()}var l=new i.Box(u.x,u.y,c.x-u.x,c.y-u.y),h=[];l.left=Math.round(l.left);l.top=Math.round(l.top);l.right=Math.round(l.right);l.bottom=Math.round(l.bottom);n.getDrawer().pipe(function(){this.clear();this.moveTo(l.left,l.top);this.lineTo(l.right,l.top);this.lineTo(l.right,l.bottom);this.lineTo(l.left,l.bottom);this.close()});e.getRoot().traverse(function(e){var t=e.getLayoutBox();if(!t.intersect(l).isEmpty()){h.push(e)}});e.select(h,true);window.getSelection().removeAllRanges()},selectEnd:function(e){if(r){r=null}if(a){n.fadeOut(200,"ease",0,function(){if(n.remove)n.remove()});a=false}}}}();var n=null,a=null;return{init:function(){window.addEventListener("mouseup",function(){r.selectEnd()})},events:{mousedown:function(e){var t=e.getTargetNode();if(!t){this.removeAllSelectedNodes();r.selectStart(e);this.setStatus("normal")}else if(e.isShortcutKey("Ctrl")){this.toggleSelect(t)}else if(!t.isSelected()){this.select(t,true)}else if(!this.isSingleSelect()){n=t;a=e.getPosition()}},mousemove:r.selectMove,mouseup:function(e){var t=e.getTargetNode();if(t&&t==n){var o=e.getPosition();var s=i.Vector.fromPoints(a,o);if(s.length()<1)this.select(n,true);n=null}r.selectEnd(e)},"normal.keydown":function(e){if(e.isShortcutKey("ctrl+a")){var t=[];this.getRoot().traverse(function(e){t.push(e)});this.select(t,true);e.preventDefault()}}}}})}};e[59]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("StyleModule",function(){
var e=["font-size","font-family","font-weight","font-style","background","color"];var t=null;function r(t){var r=t.getData();for(var n=0;n<e.length;n++){if(e[n]in r)return true}}return{commands:{copystyle:i.createClass("CopyStyleCommand",{base:u,execute:function(r){var n=r.getSelectedNode();var i=n.getData();t={};e.forEach(function(e){if(e in i)t[e]=i[e];else{t[e]=null;delete t[e]}});return t},queryState:function(e){var t=e.getSelectedNodes();if(t.length!==1)return-1;return r(t[0])?0:-1}}),pastestyle:i.createClass("PastStyleCommand",{base:u,execute:function(e){e.getSelectedNodes().forEach(function(e){for(var r in t){if(t.hasOwnProperty(r))e.setData(r,t[r])}});e.renderNodeBatch(e.getSelectedNodes());e.layout(300);return t},queryState:function(e){return t&&e.getSelectedNodes().length?0:-1}}),clearstyle:i.createClass("ClearStyleCommand",{base:u,execute:function(r){r.getSelectedNodes().forEach(function(t){e.forEach(function(e){t.setData(e)})});r.renderNodeBatch(r.getSelectedNodes());r.layout(300);return t},queryState:function(e){var t=e.getSelectedNodes();if(!t.length)return-1;for(var n=0;n<t.length;n++){if(r(t[n]))return 0}return-1}})}}})}};e[60]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);var h={safari:{"Microsoft YaHei,Microsoft YaHei":-.17,"楷体,楷体_GB2312,SimKai":-.1,"隶书, SimLi":-.1,"comic sans ms":-.23,"impact,chicago":-.15,"times new roman":-.1,"arial black,avant garde":-.17,default:0},ie:{10:{"Microsoft YaHei,Microsoft YaHei":-.17,"comic sans ms":-.17,"impact,chicago":-.08,"times new roman":.04,"arial black,avant garde":-.17,default:-.15},11:{"Microsoft YaHei,Microsoft YaHei":-.17,"arial,helvetica,sans-serif":-.17,"comic sans ms":-.17,"impact,chicago":-.08,"times new roman":.04,"sans-serif":-.16,"arial black,avant garde":-.17,default:-.15}},edge:{"Microsoft YaHei,Microsoft YaHei":-.15,"arial,helvetica,sans-serif":-.17,"comic sans ms":-.17,"impact,chicago":-.08,"sans-serif":-.16,"arial black,avant garde":-.17,default:-.15},sg:{"Microsoft YaHei,Microsoft YaHei":-.15,"arial,helvetica,sans-serif":-.05,"comic sans ms":-.22,"impact,chicago":-.16,"times new roman":-.03,"arial black,avant garde":-.22,default:-.15},chrome:{Mac:{"andale mono":-.05,"comic sans ms":-.3,"impact,chicago":-.13,"times new roman":-.1,"arial black,avant garde":-.17,default:0},Win:{"Microsoft YaHei,Microsoft YaHei":-.15,"arial,helvetica,sans-serif":-.02,"arial black,avant garde":-.2,"comic sans ms":-.2,"impact,chicago":-.12,"times new roman":-.02,default:-.15},Lux:{"andale mono":-.05,"comic sans ms":-.3,"impact,chicago":-.13,"times new roman":-.1,"arial black,avant garde":-.17,default:0}},firefox:{Mac:{"Microsoft YaHei,Microsoft YaHei":-.2,"宋体,SimSun":.05,"comic sans ms":-.2,"impact,chicago":-.15,"arial black,avant garde":-.17,"times new roman":-.1,default:.05},Win:{"Microsoft YaHei,Microsoft YaHei":-.16,"andale mono":-.17,"arial,helvetica,sans-serif":-.17,"comic sans ms":-.22,"impact,chicago":-.23,"times new roman":-.22,"sans-serif":-.22,"arial black,avant garde":-.17,default:-.16},Lux:{"宋体,SimSun":-.2,"Microsoft YaHei,Microsoft YaHei":-.2,"黑体, SimHei":-.2,"隶书, SimLi":-.2,"楷体,楷体_GB2312,SimKai":-.2,"andale mono":-.2,"arial,helvetica,sans-serif":-.2,"comic sans ms":-.2,"impact,chicago":-.2,"times new roman":-.2,"sans-serif":-.2,"arial black,avant garde":-.2,default:-.16}}};var d=i.createClass("TextRenderer",{base:l,create:function(){return(new i.Group).setId(a.uuid("node_text"))},update:function(e,t){function r(e){return t.getData(e)||t.getStyle(e)}var n=t.getText();var a=n?n.split("\n"):[" "];var o=t.getStyle("line-height");var s=r("font-size");var u=r("font-family")||"default";var c=o*s*a.length-(o-1)*s;var l=-c/2;var d=i.Browser;var f;if(d.chrome||d.opera||d.bd||d.lb==="chrome"){f=h["chrome"][d.platform][u]}else if(d.gecko){f=h["firefox"][d.platform][u]}else if(d.sg){f=h["sg"][u]}else if(d.safari){f=h["safari"][u]}else if(d.ie){f=h["ie"][d.version][u]}else if(d.edge){f=h["edge"][u]}else if(d.lb){f=.9}e.setTranslate(0,(f||0)*s);var g=new i.Box,v=Math.round;this.setTextStyle(t,e);var p=a.length;var m=e.getItems().length;var y,w,b,x;if(p<m){for(y=p,w;w=e.getItem(y);){e.removeItem(y)}}else if(p>m){var S=p-m;while(S--){b=(new i.Text).setAttr("text-rendering","inherit");if(i.Browser.ie||i.Browser.edge){b.setVerticalAlign("top")}else{b.setAttr("dominant-baseline","text-before-edge")}e.addItem(b)}}for(y=0,x,b;x=a[y],b=e.getItem(y);y++){b.setContent(x);if(i.Browser.ie||i.Browser.edge){b.fixPosition()}}this.setTextStyle(t,e);var C=t.getText()+["font-size","font-name","font-weight","font-style"].map(r).join("/");if(t._currentTextHash==C&&t._currentTextGroupBox)return t._currentTextGroupBox;t._currentTextHash=C;return function(){e.eachItem(function(e,t){var r=l+e*s*o;t.setY(r);var n=t.getBoundaryBox();g=g.merge(new i.Box(0,r,n.height&&n.width||1,s))});var r=new i.Box(v(g.x),v(g.y),v(g.width),v(g.height));t._currentTextGroupBox=r;return r}},setTextStyle:function(e,t){var r=d._styleHooks;r.forEach(function(r){r(e,t)})}});var f=i.createClass({base:u,execute:function(e,t){var r=e.getSelectedNode();if(r){r.setText(t);r.render();e.layout()}},queryState:function(e){return e.getSelectedNodes().length==1?0:-1},queryValue:function(e){var t=e.getSelectedNode();return t?t.getText():null}});a.extend(d,{_styleHooks:[],registerStyleHook:function(e){d._styleHooks.push(e)}});i.extendClass(s,{getTextGroup:function(){return this.getRenderer("TextRenderer").getRenderShape()}});c.register("text",{commands:{text:f},renderers:{center:d}});n.exports=d}};e[61]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);var h=i.createClass("ViewDragger",{constructor:function(e){this._minder=e;this._enabled=false;this._bind();var t=this;this._minder.getViewDragger=function(){return t};this.setEnabled(false)},isEnabled:function(){return this._enabled},setEnabled:function(e){var t=this._minder.getPaper();t.setStyle("cursor",e?"pointer":"default");t.setStyle("cursor",e?"-webkit-grab":"default");this._enabled=e},timeline:function(){return this._moveTimeline},move:function(e,t){var r=this._minder;var n=this.getMovement().offset(e);this.moveTo(n,t)},moveTo:function(e,t){if(t){var r=this;if(this._moveTimeline)this._moveTimeline.stop();this._moveTimeline=this._minder.getRenderContainer().animate(new i.Animator(this.getMovement(),e,function(e,t){r.moveTo(t)}),t,"easeOutCubic").timeline();this._moveTimeline.on("finish",function(){r._moveTimeline=null});return this}this._minder.getRenderContainer().setTranslate(e.round());this._minder.fire("viewchange")},getMovement:function(){var e=this._minder.getRenderContainer().transform.translate;return e?e[0]:new i.Point},getView:function(){var e=this._minder;var t=e._lastClientSize||{width:e.getRenderTarget().clientWidth,height:e.getRenderTarget().clientHeight};var r=this.getMovement();var n=new i.Box(0,0,t.width,t.height);var a=e.getPaper().getViewPortMatrix();return a.inverse().translate(-r.x,-r.y).transformBox(n)},_bind:function(){var e=this,t=false,r=null,n=null;function a(n){if(!r)return;r=null;n.stopPropagation();if(t){e.setEnabled(false);t=false;if(e._minder.getStatus()=="hand")e._minder.rollbackStatus()}var i=e._minder.getPaper();i.setStyle("cursor",e._minder.getStatus()=="hand"?"-webkit-grab":"default");e._minder.fire("viewchanged")}this._minder.on("normal.mousedown normal.touchstart "+"inputready.mousedown inputready.touchstart "+"readonly.mousedown readonly.touchstart",function(e){if(e.originEvent.button==2){e.originEvent.preventDefault()}if(e.getTargetNode()==this.getRoot()||e.originEvent.button==2||e.originEvent.altKey){r=e.getPosition("view");t=true}}).on("normal.mousemove normal.touchmove "+"readonly.mousemove readonly.touchmove "+"inputready.mousemove inputready.touchmove",function(n){if(n.type=="touchmove"){n.preventDefault()}if(!t)return;var a=i.Vector.fromPoints(r,n.getPosition("view"));if(a.length()>10){this.setStatus("hand",true);var o=e._minder.getPaper();o.setStyle("cursor","-webkit-grabbing")}}).on("hand.beforemousedown hand.beforetouchstart",function(t){if(e.isEnabled()){r=t.getPosition("view");t.stopPropagation();var n=e._minder.getPaper();n.setStyle("cursor","-webkit-grabbing")}}).on("hand.beforemousemove hand.beforetouchmove",function(t){if(r){n=t.getPosition("view");var a=i.Vector.fromPoints(r,n);e.move(a);t.stopPropagation();t.preventDefault();t.originEvent.preventDefault();r=n}}).on("mouseup touchend",a);window.addEventListener("mouseup",a);this._minder.on("contextmenu",function(e){e.preventDefault()})}});c.register("View",function(){var e=this;var t=i.createClass("ToggleHandCommand",{base:u,execute:function(e){if(e.getStatus()!="hand"){e.setStatus("hand",true)}else{e.rollbackStatus()}this.setContentChanged(false)},queryState:function(e){return e.getStatus()=="hand"?1:0},enableReadOnly:true});var r=i.createClass("CameraCommand",{base:u,execute:function(e,t){t=t||e.getRoot();var r=e.getPaper().getViewPort();var n=t.getRenderContainer().getRenderBox("view");var a=r.center.x-n.x-n.width/2,o=r.center.y-n.y;var s=e._viewDragger;var u=e.getOption("viewAnimationDuration");s.move(new i.Point(a,o),u);this.setContentChanged(false)},enableReadOnly:true});var n=i.createClass("MoveCommand",{base:u,execute:function(e,t){var r=e._viewDragger;var n=e._lastClientSize;var a=e.getOption("viewAnimationDuration");switch(t){case"up":r.move(new i.Point(0,n.height/2),a);break;case"down":r.move(new i.Point(0,-n.height/2),a);break;case"left":r.move(new i.Point(n.width/2,0),a);break;case"right":r.move(new i.Point(-n.width/2,0),a);break}},enableReadOnly:true});return{init:function(){this._viewDragger=new h(this)},commands:{hand:t,camera:r,move:n},events:{statuschange:function(e){this._viewDragger.setEnabled(e.currentStatus=="hand")},mousewheel:function(e){var t,r;e=e.originEvent;if(e.ctrlKey||e.shiftKey)return;if("wheelDeltaX"in e){t=e.wheelDeltaX||0;r=e.wheelDeltaY||0}else{t=0;r=e.wheelDelta}this._viewDragger.move({x:t/2.5,y:r/2.5});var n=this;clearTimeout(this._mousewheeltimer);this._mousewheeltimer=setTimeout(function(){n.fire("viewchanged")},100);e.preventDefault()},"paperrender finishInitHook":function(){if(!this.getRenderTarget()){return}this.execCommand("camera",null,0);this._lastClientSize={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight}},resize:function(e){var t={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight},r=this._lastClientSize;this._viewDragger.move(new i.Point((t.width-r.width)/2|0,(t.height-r.height)/2|0));this._lastClientSize=t},"selectionchange layoutallfinish":function(e){var t=this.getSelectedNode();var r=this;if(i.Browser.edge){this.fire("paperrender")}if(!t)return;var n=this._viewDragger;var a=n.timeline();if(a){a.on("finish",function(){r.fire("selectionchange")});return}var o=n.getView();var s=t.getLayoutBox();var u=50;var c=0,l=0;if(s.right>o.right){c+=o.right-s.right-u}else if(s.left<o.left){c+=o.left-s.left+u}if(s.bottom>o.bottom){l+=o.bottom-s.bottom-u}if(s.top<o.top){l+=o.top-s.top+u}if(c||l)n.move(new i.Point(c,l),100)}}}})}};e[62]={value:function(t,r,n){var i=e.r(17);var a=e.r(33);var o=e.r(19);var s=e.r(21);var u=e.r(9);var c=e.r(20);var l=e.r(27);c.register("Zoom",function(){var e=this;var t;function r(){var t=e._zoomValue>=100?"optimize-speed":"geometricPrecision";e.getRenderContainer().setAttr("text-rendering",t)}function n(e){var t=e.shapeNode;var r=t.getCTM();var n=new i.Matrix(r.a,r.b,r.c,r.d,(r.e|0)+.5,(r.f|0)+.5);t.setAttribute("transform","matrix("+n.toString()+")")}i.extendClass(o,{zoom:function(e){var t=this.getPaper();var r=t.getViewPort();r.zoom=e/100;r.center={x:r.center.x,y:r.center.y};t.setViewPort(r);if(e==100)n(t)},getZoomValue:function(){return this._zoomValue}});function a(e,n){var a=e.getPaper();var o=a.getViewPort();if(!n)return;r();var s=e.getOption("zoomAnimationDuration");if(e.getRoot().getComplex()>200||!s){e._zoomValue=n;e.zoom(n);e.fire("viewchange")}else{var u=new i.Animator({beginValue:e._zoomValue,finishValue:n,setter:function(e,t){e.zoom(t)}});e._zoomValue=n;if(t){t.pause()}t=u.start(e,s,"easeInOutSine");t.on("finish",function(){e.fire("viewchange")})}e.fire("zoom",{zoom:n})}var s=i.createClass("Zoom",{base:u,execute:a,queryValue:function(e){return e._zoomValue}});var c=i.createClass("ZoomInCommand",{base:u,execute:function(e){a(e,this.nextValue(e))},queryState:function(e){return+!this.nextValue(e)},nextValue:function(e){var t=e.getOption("zoom"),r;for(r=0;r<t.length;r++){if(t[r]>e._zoomValue)return t[r]}return 0},enableReadOnly:true});var l=i.createClass("ZoomOutCommand",{base:u,execute:function(e){a(e,this.nextValue(e))},queryState:function(e){return+!this.nextValue(e)},nextValue:function(e){var t=e.getOption("zoom"),r;for(r=t.length-1;r>=0;r--){if(t[r]<e._zoomValue)return t[r]}return 0},enableReadOnly:true});return{init:function(){this._zoomValue=100;this.setDefaultOptions({zoom:[10,20,30,50,80,100,120,150,200]});r()},commands:{zoomin:c,zoomout:l,zoom:s},events:{"normal.mousewheel readonly.mousewheel":function(e){if(!e.originEvent.ctrlKey&&!e.originEvent.metaKey)return;var t=e.originEvent.wheelDelta;var r=this;if(!i.Browser.mac){t=-t}if(Math.abs(t)>100){clearTimeout(this._wheelZoomTimeout)}else{return}this._wheelZoomTimeout=setTimeout(function(){var e;var n=r.getPaper()._zoom||1;if(t<0){r.execCommand("zoom-in")}else if(t>0){r.execCommand("zoom-out")}},100);e.originEvent.preventDefault()}},commandShortcutKeys:{zoomin:"ctrl+=",zoomout:"ctrl+-"}}})}};e[63]={value:function(t,r,n){var i=e.r(12);i.registerProtocol("json",n.exports={fileDescription:"KityMinder 格式",fileExtension:".km",dataType:"text",mineType:"application/json",encode:function(e){return JSON.stringify(e)},decode:function(e){return JSON.parse(e)}})}};e[64]={value:function(t,r,n){var i=e.r(12);var a=/\r\n|\r|\n/;var o="";var s="<!--Note-->";var u="<!--/Note-->";function c(e){return l(e,1).join("\n")}function l(e,t){var r=[];t=t||1;var n=h(t);r.push(n+" "+e.data.text);r.push(o);var i=e.data.note;if(i){var a=/^#/.test(i);if(a){r.push(s);i=i.replace(/^#+/gm,function(e){return n+e})}r.push(i);if(a){r.push(u)}r.push(o)}if(e.children)e.children.forEach(function(e){r=r.concat(l(e,t+1))});return r}function h(e){var t="";while(e--)t+="#";return t}function d(e){var t,r={},n,i,o,s,u,c,l,h;e=e.replace(/^(.+)\n={3,}/,function(e,t){return"# "+t});n=e.split(a);for(var d=0;d<n.length;d++){i=n[d];o=p(i);if(o.noteClose){l=false;continue}else if(o.noteStart){l=true;continue}h=o.codeBlock?!h:h;if(l||h||!o.level||o.level>s+1){if(u)g(u,i);continue}s=o.level;u=f(o.content,r[s-1]);r[s]=u}m(r[1]);return r[1]}function f(e,t){var r={data:{text:e,note:""}};if(t){if(t.children)t.children.push(r);else t.children=[r]}return r}function g(e,t){e.data.note+=t+"\n"}function v(e){return!/\S/.test(e)}function p(e){var t=/^(#+)?\s*(.*)$/.exec(e);return{level:t[1]&&t[1].length||null,content:t[2],noteStart:e==s,noteClose:e==u,codeBlock:/^\s*```/.test(e)}}function m(e){if(!/\S/.test(e.data.note)){e.data.note=null;delete e.data.note}else{var t=e.data.note.split("\n");while(t.length&&!/\S/.test(t[0]))t.shift();while(t.length&&!/\S/.test(t[t.length-1]))t.pop();e.data.note=t.join("\n")}if(e.children)e.children.forEach(m)}i.registerProtocol("markdown",n.exports={fileDescription:"Markdown/GFM 格式",fileExtension:".md",mineType:"text/markdown",dataType:"text",encode:function(e){return c(e.root)},decode:function(e){return d(e)}})}};e[65]={value:function(t,r,n){var i=e.r(17);var a=e.r(12);var o=e.r(25);var s=window.URL||window.webkitURL||window;function u(e,t){return new o(function(t,r){var n=document.createElement("img");n.onload=function(){t({element:this,x:e.x,y:e.y,width:e.width,height:e.height})};n.onerror=function(e){r(e)};n.crossOrigin="";n.src=e.url})}function c(e){var t=e.getPaper(),r,n=t.container,i,a,o,u=e.getRenderContainer(),c=u.getRenderBox(),l=c.width+1,h=c.height+1,d,f,g;r=t.shapeNode.getAttribute("transform");t.shapeNode.setAttribute("transform","translate(0.5, 0.5)");u.translate(-c.x,-c.y);i=t.container.innerHTML;u.translate(c.x,c.y);t.shapeNode.setAttribute("transform",r);a=document.createElement("div");a.innerHTML=i;o=a.querySelector("svg");o.setAttribute("width",c.width+1);o.setAttribute("height",c.height+1);o.setAttribute("style",'font-family: Arial, "Microsoft Yahei","Heiti SC";');a=document.createElement("div");a.appendChild(o);i=a.innerHTML;i=i.replace(' xmlns="http://www.w3.org/2000/svg" '+'xmlns:NS1="" NS1:ns1:xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:NS2="" NS2:xmlns:ns1=""',"");i=i.replace(/&nbsp;/g,"&#xa0;");d=new Blob([i],{type:"image/svg+xml"});f=s.createObjectURL(d);var v=e.getAllNode();var p=[];for(var m=0;m<v.length;m++){var y=v[m].data;if(y.image){e.renderNode(v[m]);var w=y.image;var b=y.imageSize;var x=v[m].getRenderBox("ImageRenderer",e.getRenderContainer());var S={url:w,width:b.width,height:b.height,x:-u.getBoundaryBox().x+x.x+20,y:-u.getBoundaryBox().y+x.y+20};p.push(S)}}return{width:l,height:h,dataUrl:f,xml:i,imagesInfo:p}}function l(e,t){var r;var n=kityminder.Promise;var a=document.createElement("canvas");var o=a.getContext("2d");var l=t.getStyle("background").toString();var h=/url\(\"(.+)\"\)/.exec(l);var d=i.Color.parse(l);var f=c(t);var g=f.width;var v=f.height;var p=f.dataUrl;var m=f.imagesInfo;var y=20;a.width=g+y*2;a.height=v+y*2;function w(e,t){e.save();e.fillStyle=t;e.fillRect(0,0,a.width,a.height);e.restore()}function b(e,t,r,n,i,a){if(i&&a){e.drawImage(t,r,n,i,a)}else{e.drawImage(t,r,n)}}function x(e){return e.toDataURL("image/png")}function S(e){var t=e.map(function(e){return u(e)});return n.all(t)}function C(){var e={url:p};return u(e).then(function(e){b(o,e.element,y,y);return S(m)}).then(function(e){for(var t=0;t<e.length;t++){b(o,e[t].element,e[t].x,e[t].y,e[t].width,e[t].height)}s.revokeObjectURL(p);document.body.appendChild(a);return x(a)},function(e){alert("脑图的节点中包含跨域图片，导出的 png 中节点图片不显示，你可以替换掉这些跨域的图片并重试。");s.revokeObjectURL(p);document.body.appendChild(a);return x(a)})}if(h){var _={url:h[1]};return u(_).then(function(e){w(o,o.createPattern(e.element,"repeat"));return C()})}else{w(o,d.toString());return C()}}a.registerProtocol("png",n.exports={fileDescription:"PNG 图片",fileExtension:".png",mineType:"image/png",dataType:"base64",encode:l})}};e[66]={value:function(t,r,n){var i=e.r(12);function a(e,t,r){function n(e,t){var r;try{r=t.getScreenCTM().inverse()}catch(e){throw new Error("Can not inverse source element' ctm.")}return r.multiply(e.getScreenCTM())}function i(e,t){if(!(t instanceof Function)){t=function(){}}var r=[],n=[],i=[];for(var a=0,o=e.length;a<o;a++){switch(e[a]){case"M":case"L":case"T":case"S":case"A":case"C":case"H":case"V":case"Q":{if(i.length){n.push(i.join(""));i=[]}if(n[n.length-1]===","){n.pop()}if(n.length){t(n);r.push(n.join(""));n=[]}n.push(e[a]);break}case"Z":case"z":{n.push(i.join(""),e[a]);t(n);r.push(n.join(""));i=[];n=[];break}case".":case"e":{i.push(e[a]);break}case"-":{if(e[a-1]!=="e"){if(i.length){n.push(i.join(""),",")}i=[]}i.push("-");break}case" ":case",":{if(i.length){n.push(i.join(""),",");i=[]}break}default:{if(/\d/.test(e[a])){i.push(e[a])}else{if(i.length){n.push(i.join(""),e[a]);i=[]}else{if(n[n.length-1]===","){n.pop()}n.push(e[a])}}if(a+1===o){if(i.length){n.push(i.join(""))}t(n);r.push(n.join(""));i=null;n=null}}}}return r.join("")}function a(e,t,r){if(!e){return}if(e.tagName==="defs"){return}if(e.getAttribute("fill")==="transparent"){e.setAttribute("fill","none")}if(e.getAttribute("marker-end")){e.removeAttribute("marker-end")}t=t||0;r=r||0;if(e.getAttribute("transform")){var o=n(e,e.parentElement);t-=o.e;r-=o.f;e.removeAttribute("transform")}switch(e.tagName.toLowerCase()){case"g":break;case"path":{var s=e.getAttribute("d");if(s){s=i(s,function(e){switch(e[0]){case"V":{e[1]=+e[1]-r;break}case"H":{e[1]=+e[1]-t;break}case"M":case"L":case"T":{e[1]=+e[1]-t;e[3]=+e[3]-r;break}case"Q":case"S":{e[1]=+e[1]-t;e[3]=+e[3]-r;e[5]=+e[5]-t;e[7]=+e[7]-r;break}case"A":{e[11]=+e[11]-t;e[13]=+e[13]-r;break}case"C":{e[1]=+e[1]-t;e[3]=+e[3]-r;e[5]=+e[5]-t;e[7]=+e[7]-r;e[9]=+e[9]-t;e[11]=+e[11]-r}}});e.setAttribute("d",s);e.removeAttribute("transform")}return}case"image":case"text":{if(t&&r){var u=+e.getAttribute("x")||0,c=+e.getAttribute("y")||0;e.setAttribute("x",u-t);e.setAttribute("y",c-r)}if(e.getAttribute("dominant-baseline")){e.removeAttribute("dominant-baseline");e.setAttribute("dy",".8em")}e.removeAttribute("transform");return}}if(e.children){for(var l=0,h=e.children.length;l<h;l++){a(e.children[l],t,r)}}}e.style.display="none";a(e,t||0,r||0);e.style.display="inline"}i.registerProtocol("svg",n.exports={fileDescription:"SVG 矢量图",fileExtension:".svg",mineType:"image/svg+xml",dataType:"text",encode:function(e,t){var r=t.getPaper(),n=r.shapeNode.getAttribute("transform"),i,o,s,u=t.getRenderContainer(),c=u.getRenderBox(),l=u.getTransform(),h=c.width,d=c.height,f=20;r.shapeNode.setAttribute("transform","translate(0.5, 0.5)");i=r.container.innerHTML;r.shapeNode.setAttribute("transform",n);o=document.createElement("div");o.innerHTML=i;s=o.querySelector("svg");s.setAttribute("width",h+f*2|0);s.setAttribute("height",d+f*2|0);s.setAttribute("style","background: "+t.getStyle("background"));s.setAttribute("viewBox",[0,0,h+f*2|0,d+f*2|0].join(" "));o=document.createElement("div");a(s,c.x-f|0,c.y-f|0);o.appendChild(s);i=o.innerHTML;i=i.replace(/&nbsp;/g,"&#xa0;");return i}})}};e[67]={value:function(t,r,n){var i=e.r(12);var a=e.r(17).Browser;var o="\r",s=/\r\n|\r|\n/,u=function(e){if(e.gecko){return{REGEXP:new RegExp("^(\t|"+String.fromCharCode(160,160,32,160)+")"),DELETE:new RegExp("^(\t|"+String.fromCharCode(160,160,32,160)+")+")}}else if(e.ie||e.edge){return{REGEXP:new RegExp("^("+String.fromCharCode(32)+"|"+String.fromCharCode(160)+")"),DELETE:new RegExp("^("+String.fromCharCode(32)+"|"+String.fromCharCode(160)+")+")}}else{return{REGEXP:/^(\t|\x20{4})/,DELETE:/^(\t|\x20{4})+/}}}(a);function c(e,t){var r="";while(t--)r+=e;return r}function l(e){if(!e){return""}var t=[],r=["\\","n"];for(var n=0,i=0,a=e.length;n<a;n++){if(e[n]==="\n"||e[n]==="\r"){t.push("\\n");i=0;continue}if(e[n]===r[i]){i++;if(i===2){i=0;t.push("\\\\n")}continue}switch(i){case 0:{t.push(e[n]);break}case 1:{t.push(e[n-1],e[n])}}i=0}return t.join("")}function h(e){if(!e){return""}var t=[],r=["\\","\\","n"];for(var n=0,i=0,a=e.length;n<a;n++){if(e[n]===r[i]){i++;if(i===3){i=0;t.push("\\n")}continue}switch(i){case 0:{t.push(e[n]);i=0;break}case 1:{if(e[n]==="n"){t.push("\n")}else{t.push(e[n-1],e[n])}i=0;break}case 2:{t.push(e[n-2]);if(e[n]!=="\\"){i=0;t.push(e[n-1],e[n])}break}}}return t.join("")}function d(e,t){var r="";t=t||0;r+=c("\t",t);r+=l(e.data.text)+o;if(e.children){e.children.forEach(function(e){r+=d(e,t+1)})}return r}function f(e){return!/\S/.test(e)}function g(e){var t=0;while(u.REGEXP.test(e)){e=e.replace(u.REGEXP,"");t++}return t}function v(e){return{data:{text:h(e.replace(u.DELETE,""))}}}function p(e){var t,r={},n=e.split(s),i,a,o;function u(e,t){var r=e.children||(e.children=[]);r.push(t)}for(var c=0;c<n.length;c++){i=n[c];if(f(i))continue;a=g(i);o=v(i);if(a===0){if(t){throw new Error("Invalid local format")}t=o}else{if(!r[a-1]){throw new Error("Invalid local format")}u(r[a-1],o)}r[a]=o}return t}function m(e){function t(e){var r={};r.data=e.getData();var n=e.getChildren();r.children=[];for(var i=0;i<n.length;i++){r.children.push(t(n[i]))}return r}if(!e)return;if(/^\s*$/.test(e.data.text)){e.data.text="分支主题"}return d(t(e))}i.registerProtocol("text",n.exports={fileDescription:"大纲文本",fileExtension:".txt",dataType:"text",mineType:"text/plain",encode:function(e){return d(e.root,0)},decode:function(e){return p(e)},Node2Text:function(e){return m(e)}})}};e[68]={value:function(t,r,n){var i=e.r(31);i.register("default",{getLayout:function(e){if(e.getData("layout"))return e.getData("layout");var t=e.getLevel();if(t===0){return"mind"}if(t===1){return e.getLayoutPointPreview().x>0?"right":"left"}return e.parent.getLayout()},getConnect:function(e){if(e.getLevel()==1)return"arc";return"under"}})}};e[69]={value:function(t,r,n){var i=e.r(31);i.register("filetree",{getLayout:function(e){if(e.getData("layout"))return e.getData("layout");if(e.isRoot())return"bottom";return"filetree-down"},getConnect:function(e){if(e.getLevel()==1){return"poly"}return"l"}})}};e[70]={value:function(t,r,n){var i=e.r(31);i.register("fish-bone",{getLayout:function(e){if(e.getData("layout"))return e.getData("layout");var t=e.getLevel();if(t===0){return"fish-bone-master"}if(t===1){return"fish-bone-slave"}return e.getLayoutPointPreview().y>0?"filetree-up":"filetree-down"},getConnect:function(e){switch(e.getLevel()){case 1:return"fish-bone-master";case 2:return"line";default:return"l"}}})}};e[71]={value:function(t,r,n){var i=e.r(31);i.register("right",{getLayout:function(e){return e.getData("layout")||"right"},getConnect:function(e){if(e.getLevel()==1)return"arc";return"bezier"}})}};e[72]={value:function(t,r,n){var i=e.r(31);i.register("structure",{getLayout:function(e){return e.getData("layout")||"bottom"},getConnect:function(e){return"poly"}})}};e[73]={value:function(t,r,n){var i=e.r(31);i.register("tianpan",{getLayout:function(e){if(e.getData("layout"))return e.getData("layout");var t=e.getLevel();if(t===0){return"tianpan"}return e.parent.getLayout()},getConnect:function(e){return"arc_tp"}})}};e[74]={value:function(t,r,n){var i=e.r(32);["classic","classic-compact"].forEach(function(e){var t=e=="classic-compact";i.register(e,{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":t?[10,25]:[15,25],"root-margin":t?[15,25]:[30,100],"root-radius":30,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":t?[5,15]:[6,20],"main-margin":t?[5,10]:20,"main-radius":10,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"white","sub-background":"transparent","sub-stroke":"none","sub-font-size":12,"sub-padding":[5,10],"sub-margin":t?[5,10]:[15,20],"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})})}};e[75]={value:function(t,r,n){var i=e.r(32);i.register("fish",{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":[35,35],"root-margin":30,"root-radius":100,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":[6,20],"main-margin":[20,20],"main-radius":5,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"black","sub-background":"white","sub-stroke":"white","sub-font-size":12,"sub-padding":[5,10],"sub-margin":[10],"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":3,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})}};e[76]={value:function(t,r,n){var i=e.r(17);var a=e.r(32);function o(e,t,r){return i.Color.createHSL(e,t,r)}function s(e,t){return{background:"#fbfbfb","root-color":"white","root-background":o(e,37,60),"root-stroke":o(e,37,60),"root-font-size":16,"root-padding":t?[6,12]:[12,24],"root-margin":t?10:[20,40],"root-radius":5,"root-space":10,"main-color":"black","main-background":o(e,33,95),"main-stroke":o(e,37,60),"main-stroke-width":1,"main-font-size":14,"main-padding":[6,10],"main-margin":t?8:14,"main-radius":3,"main-space":5,"sub-color":"black","sub-background":"transparent","sub-stroke":"none","sub-font-size":12,"sub-padding":t?[3,5]:[5,10],"sub-margin":t?[4,8]:[9,16],"sub-radius":5,"sub-space":5,"connect-color":o(e,37,60),"connect-width":1,"connect-radius":5,"selected-stroke":o(e,26,30),"selected-stroke-width":"3","blur-selected-stroke":o(e,10,60),"marquee-background":o(e,100,80).set("a",.1),"marquee-stroke":o(e,37,60),"drop-hint-color":o(e,26,35),"drop-hint-width":5,"order-hint-area-color":o(e,100,30).set("a",.5),"order-hint-path-color":o(e,100,25),"order-hint-path-width":1,"text-selection-color":o(e,100,20),"line-height":1.5}}var u={red:0,soil:25,green:122,blue:204,purple:246,pink:334};var c;for(c in u){a.register("fresh-"+c,s(u[c]));a.register("fresh-"+c+"-compat",s(u[c],true))}}};e[77]={value:function(t,r,n){var i=e.r(32);["snow","snow-compact"].forEach(function(e){var t=e=="snow-compact";i.register(e,{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',
"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":t?[5,10]:[15,25],"root-margin":t?15:30,"root-radius":5,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":t?[4,10]:[6,20],"main-margin":t?[5,10]:[20,40],"main-radius":5,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"black","sub-background":"white","sub-stroke":"white","sub-font-size":12,"sub-padding":[5,10],"sub-margin":t?[5,10]:[10,20],"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})})}};e[78]={value:function(t,r,n){var i=e.r(32);["tianpan","tianpan-compact"].forEach(function(e){var t=e=="tianpan-compact";i.register(e,{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":25,"root-padding":t?15:20,"root-margin":t?[15,25]:100,"root-radius":30,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","root-shape":"circle","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":15,"main-padding":t?10:12,"main-margin":t?10:12,"main-radius":10,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","main-shape":"circle","sub-color":"#333","sub-background":"#99ca6a","sub-stroke":"#a4c5c0","sub-font-size":13,"sub-padding":5,"sub-margin":t?6:10,"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"sub-shadow":"rgba(0, 0, 0, .25)","sub-shape":"circle","connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.4})})}};e[79]={value:function(t,r,n){var i=e.r(32);i.register("wire",{background:"black",color:"#999",stroke:"none",padding:10,margin:20,"font-size":14,"connect-color":"#999","connect-width":1,"selected-background":"#999","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})}};var t={"expose-kityminder":34};function r(r){e.r([t[r]])}r("expose-kityminder")})();