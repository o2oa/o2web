tinymce.PluginManager.add("insertdatetime",function(e){var t="Sun Mon Tue Wed Thu Fri Sat Sun".split(" ");var a="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" ");var n="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");var r="January February March April May June July August September October November December".split(" ");var i=[],c,d;function m(i,c){function d(e,t){e=""+e;if(e.length<t){for(var a=0;a<t-e.length;a++){e="0"+e}}return e}c=c||new Date;i=i.replace("%D","%m/%d/%Y");i=i.replace("%r","%I:%M:%S %p");i=i.replace("%Y",""+c.getFullYear());i=i.replace("%y",""+c.getYear());i=i.replace("%m",d(c.getMonth()+1,2));i=i.replace("%d",d(c.getDate(),2));i=i.replace("%H",""+d(c.getHours(),2));i=i.replace("%M",""+d(c.getMinutes(),2));i=i.replace("%S",""+d(c.getSeconds(),2));i=i.replace("%I",""+((c.getHours()+11)%12+1));i=i.replace("%p",""+(c.getHours()<12?"AM":"PM"));i=i.replace("%B",""+e.translate(r[c.getMonth()]));i=i.replace("%b",""+e.translate(n[c.getMonth()]));i=i.replace("%A",""+e.translate(a[c.getDay()]));i=i.replace("%a",""+e.translate(t[c.getDay()]));i=i.replace("%%","%");return i}function s(t){var a=m(t);if(e.settings.insertdatetime_element){var n;if(/%[HMSIp]/.test(t)){n=m("%Y-%m-%dT%H:%M")}else{n=m("%Y-%m-%d")}a='<time datetime="'+n+'">'+a+"</time>";var r=e.dom.getParent(e.selection.getStart(),"time");if(r){e.dom.setOuterHTML(r,a);return}}e.insertContent(a)}e.addCommand("mceInsertDate",function(){s(e.getParam("insertdatetime_dateformat",e.translate("%Y-%m-%d")))});e.addCommand("mceInsertTime",function(){s(e.getParam("insertdatetime_timeformat",e.translate("%H:%M:%S")))});e.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",onclick:function(){s(c||d)},menu:i});tinymce.each(e.settings.insertdatetime_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(e){if(!d){d=e}i.push({text:m(e),onclick:function(){c=e;s(e)}})});e.addMenuItem("insertdatetime",{icon:"date",text:"Insert date/time",menu:i,context:"insert"})});