tinymce.PluginManager.add("visualchars",function(e){var a=this,t;function n(n){var o,s,i,r=e.getBody(),c,l=e.selection,d,u;t=!t;a.state=t;e.fire("VisualChars",{state:t});if(n){u=l.getBookmark()}if(t){s=[];tinymce.walk(r,function(e){if(e.nodeType==3&&e.nodeValue&&e.nodeValue.indexOf("Â ")!=-1){s.push(e)}},"childNodes");for(i=0;i<s.length;i++){c=s[i].nodeValue;c=c.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mce-nbsp">$1</span>');d=e.dom.create("div",null,c);while(o=d.lastChild){e.dom.insertAfter(o,s[i])}e.dom.remove(s[i])}}else{s=e.dom.select("span.mce-nbsp",r);for(i=s.length-1;i>=0;i--){e.dom.remove(s[i],1)}}l.moveToBookmark(u)}function o(){var a=this;e.on("VisualChars",function(e){a.active(e.state)})}e.addCommand("mceVisualChars",n);e.addButton("visualchars",{title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:o});e.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:o,selectable:true,context:"view",prependToContext:true});e.on("beforegetcontent",function(e){if(t&&e.format!="raw"&&!e.draft){t=true;n(false)}})});