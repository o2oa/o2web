(function(e,t){"use strict";var n={};function o(e,t){var o,i=[];for(var r=0;r<e.length;++r){o=n[e[r]]||l(e[r]);if(!o){throw"module definition dependecy not found: "+e[r]}i.push(o)}t.apply(null,i)}function i(e,i,r){if(typeof e!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(i===t){throw"invalid module definition, dependencies must be specified"}if(r===t){throw"invalid module definition, definition function must be specified"}o(i,function(){n[e]=r.apply(null,arguments)})}function r(e){return!!n[e]}function l(t){var n=e;var o=t.split(/[.\/]/);for(var i=0;i<o.length;++i){if(!n[o[i]]){return}n=n[o[i]]}return n}function a(o){for(var i=0;i<o.length;i++){var r=e;var l=o[i];var a=l.split(/[.\/]/);for(var c=0;c<a.length-1;++c){if(r[a[c]]===t){r[a[c]]={}}r=r[a[c]]}r[a[a.length-1]]=n[l]}}i("tinymce/tableplugin/TableGrid",["tinymce/util/Tools","tinymce/Env"],function(e,n){var o=e.each;function i(e,t){return parseInt(e.getAttribute(t)||1,10)}return function(r,l){var a,c,s,f,u=r.selection,d=u.dom;function m(){var e=0;a=[];o(["thead","tbody","tfoot"],function(t){var n=d.select("> "+t+" tr",l);o(n,function(n,r){r+=e;o(d.select("> td, > th",n),function(e,n){var o,l,c,s;if(a[r]){while(a[r][n]){n++}}c=i(e,"rowspan");s=i(e,"colspan");for(l=r;l<r+c;l++){if(!a[l]){a[l]=[]}for(o=n;o<n+s;o++){a[l][o]={part:t,real:l==r&&o==n,elm:e,rowspan:c,colspan:s}}}})});e+=n.length})}function g(e,t){e=e.cloneNode(t);e.removeAttribute("id");return e}function p(e,t){var n;n=a[t];if(n){return n[e]}}function h(e,t,n){if(e){n=parseInt(n,10);if(n===1){e.removeAttribute(t,1)}else{e.setAttribute(t,n,1)}}}function b(e){return e&&(d.hasClass(e.elm,"mce-item-selected")||e==f)}function v(){var e=[];o(l.rows,function(t){o(t.cells,function(n){if(d.hasClass(n,"mce-item-selected")||f&&n==f.elm){e.push(t);return false}})});return e}function w(){var e=d.createRng();e.setStartAfter(l);e.setEndAfter(l);u.setRng(e);d.remove(l)}function y(t){var i,l={};if(r.settings.table_clone_elements!==false){l=e.makeMap((r.settings.table_clone_elements||"strong em b i span font h1 h2 h3 h4 h5 h6 p div").toUpperCase(),/[ ,]/)}e.walk(t,function(e){var r;if(e.nodeType==3){o(d.getParents(e.parentNode,null,t).reverse(),function(e){if(!l[e.nodeName]){return}e=g(e,false);if(!i){i=r=e}else if(r){r.appendChild(e)}r=e});if(r){r.innerHTML=n.ie?"&nbsp;":'<br data-mce-bogus="1" />'}return false}},"childNodes");t=g(t,false);h(t,"rowSpan",1);h(t,"colSpan",1);if(i){t.appendChild(i)}else{if(!n.ie){t.innerHTML='<br data-mce-bogus="1" />'}}return t}function x(){var e=d.createRng(),t;o(d.select("tr",l),function(e){if(e.cells.length===0){d.remove(e)}});if(d.select("tr",l).length===0){e.setStartBefore(l);e.setEndBefore(l);u.setRng(e);d.remove(l);return}o(d.select("thead,tbody,tfoot",l),function(e){if(e.rows.length===0){d.remove(e)}});m();if(c){t=a[Math.min(a.length-1,c.y)];if(t){u.select(t[Math.min(t.length-1,c.x)].elm,true);u.collapse(true)}}}function C(e,t,n,o){var i,r,l,c,s;i=a[t][e].elm.parentNode;for(l=1;l<=n;l++){i=d.getNext(i,"tr");if(i){for(r=e;r>=0;r--){s=a[t+l][r].elm;if(s.parentNode==i){for(c=1;c<=o;c++){d.insertAfter(y(s),s)}break}}if(r==-1){for(c=1;c<=o;c++){i.insertBefore(y(i.cells[0]),i.cells[0])}}}}}function R(){o(a,function(e,t){o(e,function(e,n){var o,r,l;if(b(e)){e=e.elm;o=i(e,"colspan");r=i(e,"rowspan");if(o>1||r>1){h(e,"rowSpan",1);h(e,"colSpan",1);for(l=0;l<o-1;l++){d.insertAfter(y(e),e)}C(n,t,r-1,o)}}})})}function T(t,n,i){var r,l,f,u,g,v,w,y,C,T,N;if(t){r=D(t);l=r.x;f=r.y;u=l+(n-1);g=f+(i-1)}else{c=s=null;o(a,function(e,t){o(e,function(e,n){if(b(e)){if(!c){c={x:n,y:t}}s={x:n,y:t}}})});if(c){l=c.x;f=c.y;u=s.x;g=s.y}}y=p(l,f);C=p(u,g);if(y&&C&&y.part==C.part){R();m();y=p(l,f).elm;h(y,"colSpan",u-l+1);h(y,"rowSpan",g-f+1);for(w=f;w<=g;w++){for(v=l;v<=u;v++){if(!a[w]||!a[w][v]){continue}t=a[w][v].elm;if(t!=y){T=e.grep(t.childNodes);o(T,function(e){y.appendChild(e)});if(T.length){T=e.grep(y.childNodes);N=0;o(T,function(e){if(e.nodeName=="BR"&&d.getAttrib(e,"data-mce-bogus")&&N++<T.length-1){y.removeChild(e)}})}d.remove(t)}}}x()}}function N(e){var n,r,l,c,s,f,u,m,p;o(a,function(t,i){o(t,function(t){if(b(t)){t=t.elm;s=t.parentNode;f=g(s,false);n=i;if(e){return false}}});if(e){return!n}});if(n===t){return}for(c=0;c<a[0].length;c++){if(!a[n][c]){continue}r=a[n][c].elm;if(r!=l){if(!e){p=i(r,"rowspan");if(p>1){h(r,"rowSpan",p+1);continue}}else{if(n>0&&a[n-1][c]){m=a[n-1][c].elm;p=i(m,"rowSpan");if(p>1){h(m,"rowSpan",p+1);continue}}}u=y(r);h(u,"colSpan",r.colSpan);f.appendChild(u);l=r}}if(f.hasChildNodes()){if(!e){d.insertAfter(f,s)}else{s.parentNode.insertBefore(f,s)}}}function S(e){var t,n;o(a,function(n){o(n,function(n,o){if(b(n)){t=o;if(e){return false}}});if(e){return!t}});o(a,function(o,r){var l,a,c;if(!o[t]){return}l=o[t].elm;if(l!=n){c=i(l,"colspan");a=i(l,"rowspan");if(c==1){if(!e){d.insertAfter(y(l),l);C(t,r,a-1,c)}else{l.parentNode.insertBefore(y(l),l);C(t,r,a-1,c)}}else{h(l,"colSpan",l.colSpan+1)}n=l}})}function P(){var t=[];o(a,function(n){o(n,function(n,r){if(b(n)&&e.inArray(t,r)===-1){o(a,function(e){var t=e[r].elm,n;n=i(t,"colSpan");if(n>1){h(t,"colSpan",n-1)}else{d.remove(t)}});t.push(r)}})});x()}function A(){var e;function t(e){var t,n,r;t=d.getNext(e,"tr");o(e.cells,function(e){var t=i(e,"rowSpan");if(t>1){h(e,"rowSpan",t-1);n=D(e);C(n.x,n.y,1,1)}});n=D(e.cells[0]);o(a[n.y],function(e){var t;e=e.elm;if(e!=r){t=i(e,"rowSpan");if(t<=1){d.remove(e)}else{h(e,"rowSpan",t-1)}r=e}})}e=v();o(e.reverse(),function(e){t(e)});x()}function k(){var e=v();d.remove(e);x();return e}function B(){var e=v();o(e,function(t,n){e[n]=g(t,true)});return e}function M(e,t){var n=v(),i=n[t?0:n.length-1],r=i.cells.length;if(!e){return}o(a,function(e){var t;r=0;o(e,function(e){if(e.real){r+=e.colspan}if(e.elm.parentNode==i){t=1}});if(t){return false}});if(!t){e.reverse()}o(e,function(e){var n,o=e.cells.length,l;for(n=0;n<o;n++){l=e.cells[n];h(l,"colSpan",1);h(l,"rowSpan",1)}for(n=o;n<r;n++){e.appendChild(y(e.cells[o-1]))}for(n=r;n<o;n++){d.remove(e.cells[n])}if(t){i.parentNode.insertBefore(e,i)}else{d.insertAfter(e,i)}});d.removeClass(d.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected")}function D(e){var t;o(a,function(n,i){o(n,function(n,o){if(n.elm==e){t={x:o,y:i};return false}});return!t});return t}function I(e){c=D(e)}function E(){var e,t;e=t=0;o(a,function(n,i){o(n,function(n,o){var r,l;if(b(n)){n=a[i][o];if(o>e){e=o}if(i>t){t=i}if(n.real){r=n.colspan-1;l=n.rowspan-1;if(r){if(o+r>e){e=o+r}}if(l){if(i+l>t){t=i+l}}}}})});return{x:e,y:t}}function L(e){var t,n,o,i,r,l,f,u,m,g;s=D(e);if(c&&s){t=Math.min(c.x,s.x);n=Math.min(c.y,s.y);o=Math.max(c.x,s.x);i=Math.max(c.y,s.y);r=o;l=i;for(g=n;g<=l;g++){e=a[g][t];if(!e.real){if(t-(e.colspan-1)<t){t-=e.colspan-1}}}for(m=t;m<=r;m++){e=a[n][m];if(!e.real){if(n-(e.rowspan-1)<n){n-=e.rowspan-1}}}for(g=n;g<=i;g++){for(m=t;m<=o;m++){e=a[g][m];if(e.real){f=e.colspan-1;u=e.rowspan-1;if(f){if(m+f>r){r=m+f}}if(u){if(g+u>l){l=g+u}}}}}d.removeClass(d.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected");for(g=n;g<=l;g++){for(m=t;m<=r;m++){if(a[g][m]){d.addClass(a[g][m].elm,"mce-item-selected")}}}}}l=l||d.getParent(u.getStart(),"table");m();f=d.getParent(u.getStart(),"th,td");if(f){c=D(f);s=E();f=p(c.x,c.y)}e.extend(this,{deleteTable:w,split:R,merge:T,insertRow:N,insertCol:S,deleteCols:P,deleteRows:A,cutRows:k,copyRows:B,pasteRows:M,getPos:D,setStartCell:I,setEndCell:L})}});i("tinymce/tableplugin/Quirks",["tinymce/util/VK","tinymce/Env","tinymce/util/Tools"],function(e,t,n){var o=n.each;function i(e,t){return parseInt(e.getAttribute(t)||1,10)}return function(n){function r(){function t(t){var r=t.keyCode;function l(e,o){var i=e?"previousSibling":"nextSibling";var r=n.dom.getParent(o,"tr");var l=r[i];if(l){b(n,o,l,e);t.preventDefault();return true}else{var c=n.dom.getParent(r,"table");var u=r.parentNode;var d=u.nodeName.toLowerCase();if(d==="tbody"||d===(e?"tfoot":"thead")){var m=a(e,c,u,"tbody");if(m!==null){return s(e,m,o)}}return f(e,r,i,c)}}function a(e,t,o,i){var r=n.dom.select(">"+i,t);var l=r.indexOf(o);if(e&&l===0||!e&&l===r.length-1){return c(e,t)}else if(l===-1){var a=o.tagName.toLowerCase()==="thead"?0:r.length-1;return r[a]}else{return r[l+(e?-1:1)]}}function c(e,t){var o=e?"thead":"tfoot";var i=n.dom.select(">"+o,t);return i.length!==0?i[0]:null}function s(e,o,i){var r=u(o,e);if(r){b(n,i,r,e)}t.preventDefault();return true}function f(e,o,i,r){var a=r[i];if(a){d(a);return true}else{var c=n.dom.getParent(r,"td,th");if(c){return l(e,c,t)}else{var s=u(o,!e);d(s);t.preventDefault();return false}}}function u(e,t){var o=e&&e[t?"lastChild":"firstChild"];return o&&o.nodeName==="BR"?n.dom.getParent(o,"td,th"):o}function d(e){n.selection.setCursorLocation(e,0)}function m(){return r==e.UP||r==e.DOWN}function g(e){var t=e.selection.getNode();var n=e.dom.getParent(t,"tr");return n!==null}function p(e){var t=0;var n=e;while(n.previousSibling){n=n.previousSibling;t=t+i(n,"colspan")}return t}function h(e,t){var n=0,r=0;o(e.children,function(e,o){n=n+i(e,"colspan");r=o;if(n>t){return false}});return r}function b(e,t,o,i){var r=p(n.dom.getParent(t,"td,th"));var l=h(o,r);var a=o.childNodes[l];var c=u(a,i);d(c||a)}function v(e){var t=n.selection.getNode();var o=n.dom.getParent(t,"td,th");var i=n.dom.getParent(e,"td,th");return o&&o!==i&&w(o,i)}function w(e,t){return n.dom.getParent(e,"TABLE")===n.dom.getParent(t,"TABLE")}if(m()&&g(n)){var y=n.selection.getNode();setTimeout(function(){if(v(y)){l(!t.shiftKey&&r===e.UP,y,t)}},0)}}n.on("KeyDown",function(e){t(e)})}function l(){function e(e,t){var n=t.ownerDocument,o=n.createRange(),i;o.setStartBefore(t);o.setEnd(e.endContainer,e.endOffset);i=n.createElement("body");i.appendChild(o.cloneContents());return i.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length===0}n.on("KeyDown",function(t){var o,i,r=n.dom;if(t.keyCode==37||t.keyCode==38){o=n.selection.getRng();i=r.getParent(o.startContainer,"table");if(i&&n.getBody().firstChild==i){if(e(o,i)){o=r.createRng();o.setStartBefore(i);o.setEndBefore(i);n.selection.setRng(o);t.preventDefault()}}}})}function a(){n.on("KeyDown SetContent VisualAid",function(){var e;for(e=n.getBody().lastChild;e;e=e.previousSibling){if(e.nodeType==3){if(e.nodeValue.length>0){break}}else if(e.nodeType==1&&!e.getAttribute("data-mce-bogus")){break}}if(e&&e.nodeName=="TABLE"){if(n.settings.forced_root_block){n.dom.add(n.getBody(),n.settings.forced_root_block,n.settings.forced_root_block_attrs,t.ie&&t.ie<11?"&nbsp;":'<br data-mce-bogus="1" />')}else{n.dom.add(n.getBody(),"br",{"data-mce-bogus":"1"})}}});n.on("PreProcess",function(e){var t=e.node.lastChild;if(t&&(t.nodeName=="BR"||t.childNodes.length==1&&(t.firstChild.nodeName=="BR"||t.firstChild.nodeValue==" "))&&t.previousSibling&&t.previousSibling.nodeName=="TABLE"){n.dom.remove(t)}})}function c(){function e(e,t,n,o){var i=3,r=e.dom.getParent(t.startContainer,"TABLE");var l,a,c;if(r){l=r.parentNode}a=t.startContainer.nodeType==i&&t.startOffset===0&&t.endOffset===0&&o&&(n.nodeName=="TR"||n==l);c=(n.nodeName=="TD"||n.nodeName=="TH")&&!o;return a||c}function t(){var t=n.selection.getRng();var o=n.selection.getNode();var i=n.dom.getParent(t.startContainer,"TD,TH");if(!e(n,t,o,i)){return}if(!i){i=o}var r=i.lastChild;while(r.lastChild){r=r.lastChild}t.setEnd(r,r.nodeValue.length);n.selection.setRng(t)}n.on("KeyDown",function(){t()});n.on("MouseDown",function(e){if(e.button!=2){t()}})}function s(){n.on("keydown",function(t){if((t.keyCode==e.DELETE||t.keyCode==e.BACKSPACE)&&!t.isDefaultPrevented()){var o=n.dom.getParent(n.selection.getStart(),"table");if(o){var i=n.dom.select("td,th",o),r=i.length;while(r--){if(!n.dom.hasClass(i[r],"mce-item-selected")){return}}t.preventDefault();n.execCommand("mceTableDelete")}}})}s();if(t.webkit){r();c()}if(t.gecko){l();a()}if(t.ie>10){l();a()}}});i("tinymce/tableplugin/CellSelection",["tinymce/tableplugin/TableGrid","tinymce/dom/TreeWalker","tinymce/util/Tools"],function(e,t,n){return function(o){var i=o.dom,r,l,a,c=true;function s(){o.getBody().style.webkitUserSelect="";if(c){o.dom.removeClass(o.dom.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected");c=false}}function f(t){var n,s,f=t.target;if(l&&(r||f!=l)&&(f.nodeName=="TD"||f.nodeName=="TH")){s=i.getParent(f,"table");if(s==a){if(!r){r=new e(o,s);r.setStartCell(l);o.getBody().style.webkitUserSelect="none"}r.setEndCell(f);c=true}n=o.selection.getSel();try{if(n.removeAllRanges){n.removeAllRanges()}else{n.empty()}}catch(e){}t.preventDefault()}}o.on("MouseDown",function(e){if(e.button!=2){s();l=i.getParent(e.target,"td,th");a=i.getParent(l,"table")}});o.on("mouseover",f);o.on("remove",function(){i.unbind(o.getDoc(),"mouseover",f)});o.on("MouseUp",function(){var e,c=o.selection,s,f,u,d,m;function g(o,i){var r=new t(o,o);do{if(o.nodeType==3&&n.trim(o.nodeValue).length!==0){if(i){e.setStart(o,0)}else{e.setEnd(o,o.nodeValue.length)}return}if(o.nodeName=="BR"){if(i){e.setStartBefore(o)}else{e.setEndBefore(o)}return}}while(o=i?r.next():r.prev())}if(l){if(r){o.getBody().style.webkitUserSelect=""}s=i.select("td.mce-item-selected,th.mce-item-selected");if(s.length>0){e=i.createRng();u=s[0];m=s[s.length-1];e.setStartBefore(u);e.setEndAfter(u);g(u,1);f=new t(u,i.getParent(s[0],"table"));do{if(u.nodeName=="TD"||u.nodeName=="TH"){if(!i.hasClass(u,"mce-item-selected")){break}d=u}}while(u=f.next());g(d);c.setRng(e)}o.nodeChanged();l=r=a=null}});o.on("KeyUp Drop",function(){s();l=r=a=null});return{clear:s}}});i("tinymce/tableplugin/Plugin",["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/util/Tools","tinymce/dom/TreeWalker","tinymce/Env","tinymce/PluginManager"],function(e,t,n,o,i,r,l){var a=o.each;function c(o){var i,l,c=this;function s(e){return e?e.replace(/px$/,""):""}function f(e){if(/^[0-9]+$/.test(e)){e+="px"}return e}function u(e){a("left center right".split(" "),function(t){o.formatter.remove("align"+t,{},e)})}function d(e){a("top middle bottom".split(" "),function(t){o.formatter.remove("valign"+t,{},e)})}function m(){var e=o.dom,t,n,i,l;t=e.getParent(o.selection.getStart(),"table");l={width:s(e.getStyle(t,"width")||e.getAttrib(t,"width")),height:s(e.getStyle(t,"height")||e.getAttrib(t,"height")),cellspacing:t?e.getAttrib(t,"cellspacing"):"",cellpadding:t?e.getAttrib(t,"cellpadding"):"",border:t?e.getAttrib(t,"border"):"",caption:!!e.select("caption",t)[0]};a("left center right".split(" "),function(e){if(o.formatter.matchNode(t,"align"+e)){l.align=e}});if(!t){n={label:"Cols",name:"cols"};i={label:"Rows",name:"rows"}}o.windowManager.open({title:"Table properties",items:{type:"form",layout:"grid",columns:2,data:l,defaults:{type:"textbox",maxWidth:50},items:[n,i,{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"},{label:"Alignment",minWidth:90,name:"align",type:"listbox",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]},onsubmit:function(){var n=this.toJSON(),i;o.undoManager.transact(function(){if(!t){t=v(n.cols||1,n.rows||1)}o.dom.setAttribs(t,{cellspacing:n.cellspacing,cellpadding:n.cellpadding,border:n.border});o.dom.setStyles(t,{width:f(n.width),height:f(n.height)});i=e.select("caption",t)[0];if(i&&!n.caption){e.remove(i)}if(!i&&n.caption){i=e.create("caption");i.innerHTML=!r.ie?'<br data-mce-bogus="1"/>':" ";t.insertBefore(i,t.firstChild)}u(t);if(n.align){o.formatter.apply("align"+n.align,{},t)}o.focus();o.addVisual()})}})}function g(e,t){o.windowManager.open({title:"Merge cells",body:[{label:"Cols",name:"cols",type:"textbox",size:10},{label:"Rows",name:"rows",type:"textbox",size:10}],onsubmit:function(){var n=this.toJSON();o.undoManager.transact(function(){e.merge(t,n.cols,n.rows)})}})}function p(){var e=o.dom,t,n,i=[];i=o.dom.select("td.mce-item-selected,th.mce-item-selected");t=o.dom.getParent(o.selection.getStart(),"td,th");if(!i.length&&t){i.push(t)}t=t||i[0];if(!t){return}n={width:s(e.getStyle(t,"width")||e.getAttrib(t,"width")),height:s(e.getStyle(t,"height")||e.getAttrib(t,"height")),scope:e.getAttrib(t,"scope")};n.type=t.nodeName.toLowerCase();a("left center right".split(" "),function(e){if(o.formatter.matchNode(t,"align"+e)){n.align=e}});a("top middle bottom".split(" "),function(e){if(o.formatter.matchNode(t,"valign"+e)){n.valign=e}});o.windowManager.open({title:"Cell properties",items:{type:"form",data:n,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width"},{label:"Height",name:"height"},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},onsubmit:function(){var t=this.toJSON();o.undoManager.transact(function(){a(i,function(n){o.dom.setAttrib(n,"scope",t.scope);o.dom.setStyles(n,{width:f(t.width),height:f(t.height)});if(t.type&&n.nodeName.toLowerCase()!=t.type){n=e.rename(n,t.type)}u(n);if(t.align){o.formatter.apply("align"+t.align,{},n)}d(n);if(t.valign){o.formatter.apply("valign"+t.valign,{},n)}});o.focus()})}})}function h(){var e=o.dom,t,n,i,r,l=[];t=o.dom.getParent(o.selection.getStart(),"table");n=o.dom.getParent(o.selection.getStart(),"td,th");a(t.rows,function(t){a(t.cells,function(o){if(e.hasClass(o,"mce-item-selected")||o==n){l.push(t);return false}})});i=l[0];if(!i){return}r={height:s(e.getStyle(i,"height")||e.getAttrib(i,"height")),scope:e.getAttrib(i,"scope")};r.type=i.parentNode.nodeName.toLowerCase();a("left center right".split(" "),function(e){if(o.formatter.matchNode(i,"align"+e)){r.align=e}});o.windowManager.open({title:"Row properties",items:{type:"form",data:r,columns:2,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"None",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"}]},onsubmit:function(){var t=this.toJSON(),n,i,r;o.undoManager.transact(function(){var c=t.type;a(l,function(l){o.dom.setAttrib(l,"scope",t.scope);o.dom.setStyles(l,{height:f(t.height)});if(c!=l.parentNode.nodeName.toLowerCase()){n=e.getParent(l,"table");i=l.parentNode;r=e.select(c,n)[0];if(!r){r=e.create(c);if(n.firstChild){n.insertBefore(r,n.firstChild)}else{n.appendChild(r)}}r.appendChild(l);if(!i.hasChildNodes()){e.remove(i)}}u(l);if(t.align){o.formatter.apply("align"+t.align,{},l)}});o.focus()})}})}function b(e){return function(){o.execCommand(e)}}function v(e,t){var n,i,l;l='<table id="__mce"><tbody>';for(n=0;n<t;n++){l+="<tr>";for(i=0;i<e;i++){l+="<td>"+(r.ie?" ":"<br>")+"</td>"}l+="</tr>"}l+="</tbody></table>";o.insertContent(l);var a=o.dom.get("__mce");o.dom.setAttrib(a,"id",null);return a}function w(e,t){function n(){e.disabled(!o.dom.getParent(o.selection.getStart(),t));o.selection.selectorChanged(t,function(t){e.disabled(!t)})}if(o.initialized){n()}else{o.on("init",n)}}function y(){w(this,"table")}function x(){w(this,"td,th")}function C(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++){e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(t*10+n)+'" href="#" '+'data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>'}e+="</tr>"}e+="</table>";e+='<div class="mce-text-center" role="presentation">1 x 1</div>';return e}function R(e,t,n){var i=n.getEl().getElementsByTagName("table")[0];var r,l,a,c,s;var f=n.isRtl()||n.parent().rel=="tl-tr";i.nextSibling.innerHTML=e+1+" x "+(t+1);if(f){e=9-e}for(l=0;l<10;l++){for(r=0;r<10;r++){c=i.rows[l].childNodes[r].firstChild;s=(f?r>=e:r<=e)&&l<=t;o.dom.toggleClass(c,"mce-active",s);if(s){a=c}}}return a.parentNode}if(o.settings.table_grid===false){o.addMenuItem("inserttable",{text:"Insert table",icon:"table",context:"table",onclick:m})}else{o.addMenuItem("inserttable",{text:"Insert table",icon:"table",context:"table",ariaHideMenu:true,onclick:function(e){if(e.aria){this.parent().hideAll();e.stopImmediatePropagation();m()}},onshow:function(){R(0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");o.dom.removeClass(e,"mce-active");o.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:C(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var t=e.target,n,o;if(t.tagName.toUpperCase()=="A"){n=parseInt(t.getAttribute("data-mce-x"),10);o=parseInt(t.getAttribute("data-mce-y"),10);if(this.isRtl()||this.parent().rel=="tl-tr"){n=9-n}if(n!==this.lastX||o!==this.lastY){R(n,o,e.control);this.lastX=n;this.lastY=o}}},onkeydown:function(e){var t=this.lastX,n=this.lastY,o;switch(e.keyCode){case 37:if(t>0){t--;o=true}break;case 39:o=true;if(t<9){t++}break;case 38:o=true;if(n>0){n--}break;case 40:o=true;if(n<9){n++}break}if(o){e.preventDefault();e.stopPropagation();R(t,n,e.control).focus();this.lastX=t;this.lastY=n}},onclick:function(e){if(e.target.tagName.toUpperCase()=="A"){e.preventDefault();e.stopPropagation();this.parent().cancel();v(this.lastX+1,this.lastY+1)}}}]})}o.addMenuItem("tableprops",{text:"Table properties",context:"table",onPostRender:y,onclick:m});o.addMenuItem("deletetable",{text:"Delete table",context:"table",onPostRender:y,cmd:"mceTableDelete"});o.addMenuItem("cell",{separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:b("mceTableCellProps"),onPostRender:x},{text:"Merge cells",onclick:b("mceTableMergeCells"),onPostRender:x},{text:"Split cell",onclick:b("mceTableSplitCells"),onPostRender:x}]});o.addMenuItem("row",{text:"Row",context:"table",menu:[{text:"Insert row before",onclick:b("mceTableInsertRowBefore"),onPostRender:x},{text:"Insert row after",onclick:b("mceTableInsertRowAfter"),onPostRender:x},{text:"Delete row",onclick:b("mceTableDeleteRow"),onPostRender:x},{text:"Row properties",onclick:b("mceTableRowProps"),onPostRender:x},{text:"-"},{text:"Cut row",onclick:b("mceTableCutRow"),onPostRender:x},{text:"Copy row",onclick:b("mceTableCopyRow"),onPostRender:x},{text:"Paste row before",onclick:b("mceTablePasteRowBefore"),onPostRender:x},{text:"Paste row after",onclick:b("mceTablePasteRowAfter"),onPostRender:x}]});o.addMenuItem("column",{text:"Column",context:"table",menu:[{text:"Insert column before",onclick:b("mceTableInsertColBefore"),onPostRender:x},{text:"Insert column after",onclick:b("mceTableInsertColAfter"),onPostRender:x},{text:"Delete column",onclick:b("mceTableDeleteCol"),onPostRender:x}]});var T=[];a("inserttable tableprops deletetable | cell row column".split(" "),function(e){if(e=="|"){T.push({text:"-"})}else{T.push(o.menuItems[e])}});o.addButton("table",{type:"menubutton",title:"Table",menu:T});if(!r.isIE){o.on("click",function(e){e=e.target;if(e.nodeName==="TABLE"){o.selection.select(e);o.nodeChanged()}})}c.quirks=new t(o);o.on("Init",function(){i=o.windowManager;c.cellSelection=new n(o)});a({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(e){var t,n,i;i=o.dom.getParent(o.selection.getStart(),"th,td");if(i){t=i.rowSpan;n=i.colSpan}if(!o.dom.select("td.mce-item-selected,th.mce-item-selected").length){g(e,i)}else{e.merge()}},mceTableInsertRowBefore:function(e){e.insertRow(true)},mceTableInsertRowAfter:function(e){e.insertRow()},mceTableInsertColBefore:function(e){e.insertCol(true)},mceTableInsertColAfter:function(e){e.insertCol()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){l=e.cutRows()},mceTableCopyRow:function(e){l=e.copyRows()},mceTablePasteRowBefore:function(e){e.pasteRows(l,true)},mceTablePasteRowAfter:function(e){e.pasteRows(l)},mceTableDelete:function(e){e.deleteTable()}},function(t,n){o.addCommand(n,function(){var n=new e(o);if(n){t(n);o.execCommand("mceRepaint");c.cellSelection.clear()}})});a({mceInsertTable:function(){m()},mceTableRowProps:h,mceTableCellProps:p},function(e,t){o.addCommand(t,function(t,n){e(n)})})}l.add("table",c)});a(["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/tableplugin/Plugin"])})(this);